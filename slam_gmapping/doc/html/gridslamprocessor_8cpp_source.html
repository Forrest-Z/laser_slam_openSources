<html><head><meta http-equiv="Content-Type" content="text/html;charset=utf-8">
<title>slam_gmapping: gridslamprocessor.cpp Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
<link href="tabs.css" rel="stylesheet" type="text/css">
</head>
<body onload='searchBox.OnSelectItem(0);'>
<!-- Generated by Doxygen 1.8.6 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_d44c64559bbebec7f509842c48db8b23.html">include</a></li><li class="navelem"><a class="el" href="dir_b7e82e284152fb039ff4c8aeb12fa72b.html">openslam_gmapping</a></li><li class="navelem"><a class="el" href="dir_8099b3c3d5897e1302066c0134625b2b.html">gridfastslam</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">gridslamprocessor.cpp</div>  </div>
</div><!--header-->
<div class="contents">
<a href="gridslamprocessor_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="preprocessor">#include &lt;string&gt;</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="preprocessor">#include &lt;deque&gt;</span></div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="preprocessor">#include &lt;list&gt;</span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="preprocessor">#include &lt;map&gt;</span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="preprocessor">#include &lt;set&gt;</span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="preprocessor">#include &lt;fstream&gt;</span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="preprocessor">#include &lt;iomanip&gt;</span></div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="stat_8h.html">gmapping/utils/stat.h</a>&gt;</span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="gridslamprocessor_8h.html">gmapping/gridfastslam/gridslamprocessor.h</a>&gt;</span></div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;</div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment">//#define MAP_CONSISTENCY_CHECK</span></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment">//#define GENERATE_TRAJECTORIES</span></div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;</div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="keyword">namespace </span>GMapping {</div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;</div>
<div class="line"><a name="l00016"></a><span class="lineno"><a class="line" href="namespaceGMapping.html#a907bba3f1a2120b0374630ebf6101d5a">   16</a></span>&#160;<span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code" href="namespaceGMapping.html#a907bba3f1a2120b0374630ebf6101d5a">m_distanceThresholdCheck</a> = 20;</div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;</div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="keyword">using namespace </span>std;</div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;</div>
<div class="line"><a name="l00020"></a><span class="lineno"><a class="line" href="classGMapping_1_1GridSlamProcessor.html#a736f647e15e7b3e5f853920beb7b2b80">   20</a></span>&#160;<a class="code" href="classGMapping_1_1GridSlamProcessor.html#a736f647e15e7b3e5f853920beb7b2b80">GridSlamProcessor::GridSlamProcessor</a>(): m_infoStream(cout){</div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;    </div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;    <a class="code" href="classGMapping_1_1GridSlamProcessor.html#a83d163ab15cf15856ea69507ec87904a">period_</a> = 5.0;</div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;    m_obsSigmaGain=1;</div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;    m_resampleThreshold=0.5;</div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;    m_minimumScore=0.;</div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;}</div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;</div>
<div class="line"><a name="l00028"></a><span class="lineno"><a class="line" href="classGMapping_1_1GridSlamProcessor.html#a7800b02d50b6b5d7c8b226e3c361ca2c">   28</a></span>&#160;<a class="code" href="classGMapping_1_1GridSlamProcessor.html#a736f647e15e7b3e5f853920beb7b2b80">GridSlamProcessor::GridSlamProcessor</a>(<span class="keyword">const</span> <a class="code" href="classGMapping_1_1GridSlamProcessor.html">GridSlamProcessor</a>&amp; gsp)</div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;    :last_update_time_(0.0), m_particles(gsp.m_particles), m_infoStream(cout){</div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;    </div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;    <a class="code" href="classGMapping_1_1GridSlamProcessor.html#a83d163ab15cf15856ea69507ec87904a">period_</a> = 5.0;</div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;</div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;    m_obsSigmaGain=gsp.m_obsSigmaGain;</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;    m_resampleThreshold=gsp.m_resampleThreshold;</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;    m_minimumScore=gsp.m_minimumScore;</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;    </div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;    <a class="code" href="classGMapping_1_1GridSlamProcessor.html#aec30b4ee3a767c9f50bb95236851a1be">m_beams</a>=gsp.<a class="code" href="classGMapping_1_1GridSlamProcessor.html#aec30b4ee3a767c9f50bb95236851a1be">m_beams</a>;</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;    <a class="code" href="classGMapping_1_1GridSlamProcessor.html#a79cee7069bb938f3b9d6d35b42b48ec6">m_indexes</a>=gsp.<a class="code" href="classGMapping_1_1GridSlamProcessor.html#a79cee7069bb938f3b9d6d35b42b48ec6">m_indexes</a>;</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;    <a class="code" href="classGMapping_1_1GridSlamProcessor.html#ae1fa20e9679abdbc23784e2dc17194b5">m_motionModel</a>=gsp.<a class="code" href="classGMapping_1_1GridSlamProcessor.html#ae1fa20e9679abdbc23784e2dc17194b5">m_motionModel</a>;</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;    m_resampleThreshold=gsp.m_resampleThreshold;</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;    <a class="code" href="classGMapping_1_1GridSlamProcessor.html#ac50952d259590c4aeba22eee4e6437f5">m_matcher</a>=gsp.<a class="code" href="classGMapping_1_1GridSlamProcessor.html#ac50952d259590c4aeba22eee4e6437f5">m_matcher</a>;</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;    </div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;    <a class="code" href="classGMapping_1_1GridSlamProcessor.html#a1c7e0a4fec2a31769f27fd17a9cfac3d">m_count</a>=gsp.<a class="code" href="classGMapping_1_1GridSlamProcessor.html#a1c7e0a4fec2a31769f27fd17a9cfac3d">m_count</a>;</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;    <a class="code" href="classGMapping_1_1GridSlamProcessor.html#a50a21e3936bb5c122a9e4b8039be9bc9">m_readingCount</a>=gsp.<a class="code" href="classGMapping_1_1GridSlamProcessor.html#a50a21e3936bb5c122a9e4b8039be9bc9">m_readingCount</a>;</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;    <a class="code" href="classGMapping_1_1GridSlamProcessor.html#aeddf8ebf9784e818d93a4c5bb94e3c0d">m_lastPartPose</a>=gsp.<a class="code" href="classGMapping_1_1GridSlamProcessor.html#aeddf8ebf9784e818d93a4c5bb94e3c0d">m_lastPartPose</a>;</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;    <a class="code" href="classGMapping_1_1GridSlamProcessor.html#a4435f10953b33bff663a6a7b21acb6cd">m_pose</a>=gsp.<a class="code" href="classGMapping_1_1GridSlamProcessor.html#a4435f10953b33bff663a6a7b21acb6cd">m_pose</a>;</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;    <a class="code" href="classGMapping_1_1GridSlamProcessor.html#a242df41618ccce684a01229c3c752dc9">m_odoPose</a>=gsp.<a class="code" href="classGMapping_1_1GridSlamProcessor.html#a242df41618ccce684a01229c3c752dc9">m_odoPose</a>;</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;    <a class="code" href="classGMapping_1_1GridSlamProcessor.html#a94ba410742ad6712b707e908e53da5e1">m_linearDistance</a>=gsp.<a class="code" href="classGMapping_1_1GridSlamProcessor.html#a94ba410742ad6712b707e908e53da5e1">m_linearDistance</a>;</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;    <a class="code" href="classGMapping_1_1GridSlamProcessor.html#aeede1ad148cba7c6080da5d8f00d4ac6">m_angularDistance</a>=gsp.<a class="code" href="classGMapping_1_1GridSlamProcessor.html#aeede1ad148cba7c6080da5d8f00d4ac6">m_angularDistance</a>;</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;    m_neff=gsp.m_neff;</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;    cerr &lt;&lt; <span class="stringliteral">&quot;FILTER COPY CONSTRUCTOR&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;    cerr &lt;&lt; <span class="stringliteral">&quot;m_odoPose=&quot;</span> &lt;&lt; <a class="code" href="classGMapping_1_1GridSlamProcessor.html#a242df41618ccce684a01229c3c752dc9">m_odoPose</a>.<a class="code" href="structGMapping_1_1point.html#a1e3816abbc8b56607fa741952fe74a8c">x</a> &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt;<a class="code" href="classGMapping_1_1GridSlamProcessor.html#a242df41618ccce684a01229c3c752dc9">m_odoPose</a>.<a class="code" href="structGMapping_1_1point.html#ae25e311e074409d6329c2e66741006f1">y</a> &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; <a class="code" href="classGMapping_1_1GridSlamProcessor.html#a242df41618ccce684a01229c3c752dc9">m_odoPose</a>.<a class="code" href="structGMapping_1_1orientedpoint.html#a610fdfefb42f5c836de7ab9e94ba11d0">theta</a> &lt;&lt; endl;</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;    cerr &lt;&lt; <span class="stringliteral">&quot;m_lastPartPose=&quot;</span> &lt;&lt; <a class="code" href="classGMapping_1_1GridSlamProcessor.html#aeddf8ebf9784e818d93a4c5bb94e3c0d">m_lastPartPose</a>.<a class="code" href="structGMapping_1_1point.html#a1e3816abbc8b56607fa741952fe74a8c">x</a> &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt;<a class="code" href="classGMapping_1_1GridSlamProcessor.html#aeddf8ebf9784e818d93a4c5bb94e3c0d">m_lastPartPose</a>.<a class="code" href="structGMapping_1_1point.html#ae25e311e074409d6329c2e66741006f1">y</a> &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; <a class="code" href="classGMapping_1_1GridSlamProcessor.html#aeddf8ebf9784e818d93a4c5bb94e3c0d">m_lastPartPose</a>.<a class="code" href="structGMapping_1_1orientedpoint.html#a610fdfefb42f5c836de7ab9e94ba11d0">theta</a> &lt;&lt; endl;</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;    cerr &lt;&lt; <span class="stringliteral">&quot;m_linearDistance=&quot;</span> &lt;&lt; <a class="code" href="classGMapping_1_1GridSlamProcessor.html#a94ba410742ad6712b707e908e53da5e1">m_linearDistance</a> &lt;&lt; endl;</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;    cerr &lt;&lt; <span class="stringliteral">&quot;m_angularDistance=&quot;</span> &lt;&lt; <a class="code" href="classGMapping_1_1GridSlamProcessor.html#a94ba410742ad6712b707e908e53da5e1">m_linearDistance</a> &lt;&lt; endl;</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;    </div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;    m_xmin=gsp.m_xmin;</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;    m_ymin=gsp.m_ymin;</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;    m_xmax=gsp.m_xmax;</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;    m_ymax=gsp.m_ymax;</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;    m_delta=gsp.m_delta;</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;    </div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;    m_regScore=gsp.m_regScore;</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;    m_critScore=gsp.m_critScore;</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;    m_maxMove=gsp.m_maxMove;</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;    </div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;    m_linearThresholdDistance=gsp.m_linearThresholdDistance;</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;    m_angularThresholdDistance=gsp.m_angularThresholdDistance;</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;    m_obsSigmaGain=gsp.m_obsSigmaGain;</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;    </div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;<span class="preprocessor">#ifdef MAP_CONSISTENCY_CHECK</span></div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;<span class="preprocessor"></span>    cerr &lt;&lt; __PRETTY_FUNCTION__ &lt;&lt;  <span class="stringliteral">&quot;: trajectories copy.... &quot;</span>;</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;<span class="preprocessor"></span>    <a class="code" href="classGMapping_1_1GridSlamProcessor.html#a5992af06fd86724fbdc9471b2780ab49">TNodeVector</a> v=gsp.<a class="code" href="classGMapping_1_1GridSlamProcessor.html#a046b955e24777fd727328b62f8da54d7">getTrajectories</a>();</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i=0; i&lt;v.size(); i++){</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;        <a class="code" href="classGMapping_1_1GridSlamProcessor.html#a67c2ade1a066269de12fe382999f2905">m_particles</a>[i].node=v[i];</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;    }</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;<span class="preprocessor">#ifdef MAP_CONSISTENCY_CHECK</span></div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;<span class="preprocessor"></span>    cerr &lt;&lt;  <span class="stringliteral">&quot;end&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;    cerr  &lt;&lt; <span class="stringliteral">&quot;Tree: normalizing, resetting and propagating weights within copy construction/cloneing ...&quot;</span> ;</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;    <a class="code" href="classGMapping_1_1GridSlamProcessor.html#a9984785d452344b9f6bd77c9af1ca37c">updateTreeWeights</a>(<span class="keyword">false</span>);</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;    cerr  &lt;&lt; <span class="stringliteral">&quot;.done!&quot;</span> &lt;&lt;endl;</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;}</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;</div>
<div class="line"><a name="l00090"></a><span class="lineno"><a class="line" href="classGMapping_1_1GridSlamProcessor.html#acccb98ea4c54b844acf14d7ec979e8a8">   90</a></span>&#160;<a class="code" href="classGMapping_1_1GridSlamProcessor.html#a736f647e15e7b3e5f853920beb7b2b80">GridSlamProcessor::GridSlamProcessor</a>(std::ostream&amp; infoS): m_infoStream(infoS){</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;    <a class="code" href="classGMapping_1_1GridSlamProcessor.html#a83d163ab15cf15856ea69507ec87904a">period_</a> = 5.0;</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;    m_obsSigmaGain=1;</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;    m_resampleThreshold=0.5;</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;    m_minimumScore=0.;</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;}</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;</div>
<div class="line"><a name="l00098"></a><span class="lineno"><a class="line" href="classGMapping_1_1GridSlamProcessor.html#a27039a2fcb5811629c0a1d5c96d50d95">   98</a></span>&#160;<a class="code" href="classGMapping_1_1GridSlamProcessor.html">GridSlamProcessor</a>* <a class="code" href="classGMapping_1_1GridSlamProcessor.html#a27039a2fcb5811629c0a1d5c96d50d95">GridSlamProcessor::clone</a>()<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;<span class="preprocessor"># ifdef MAP_CONSISTENCY_CHECK</span></div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;<span class="preprocessor"></span>    cerr &lt;&lt; __PRETTY_FUNCTION__ &lt;&lt; <span class="stringliteral">&quot;: performing preclone_fit_test&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;    <span class="keyword">typedef</span> std::map&lt;autoptr&lt; Array2D&lt;PointAccumulator&gt; &gt;::reference* <span class="keyword">const</span>, <span class="keywordtype">int</span>&gt; PointerMap;</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;    PointerMap pmap;</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;    <span class="keywordflow">for</span> (ParticleVector::const_iterator it=<a class="code" href="classGMapping_1_1GridSlamProcessor.html#a67c2ade1a066269de12fe382999f2905">m_particles</a>.begin(); it!=<a class="code" href="classGMapping_1_1GridSlamProcessor.html#a67c2ade1a066269de12fe382999f2905">m_particles</a>.end(); it++){</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;        <span class="keyword">const</span> <a class="code" href="classGMapping_1_1Map.html">ScanMatcherMap</a>&amp; m1(it-&gt;map);</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;        <span class="keyword">const</span> <a class="code" href="classGMapping_1_1HierarchicalArray2D.html">HierarchicalArray2D&lt;PointAccumulator&gt;</a>&amp; h1(m1.<a class="code" href="classGMapping_1_1Map.html#a8bc733ffc30a93d5ccc2d50fde1b0bcb">storage</a>());</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> x=0; x&lt;h1.getXSize(); x++){</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> y=0; y&lt;h1.getYSize(); y++){</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;                <span class="keyword">const</span> <a class="code" href="classGMapping_1_1autoptr.html">autoptr&lt; Array2D&lt;PointAccumulator&gt;</a> &gt;&amp; a1(h1.m_cells[x][y]);</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;                <span class="keywordflow">if</span> (a1.<a class="code" href="classGMapping_1_1autoptr.html#aa641f3e33480944c12157ec2dbcfba43">m_reference</a>){</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;                    PointerMap::iterator f=pmap.find(a1.<a class="code" href="classGMapping_1_1autoptr.html#aa641f3e33480944c12157ec2dbcfba43">m_reference</a>);</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;                    <span class="keywordflow">if</span> (f==pmap.end())</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;                        pmap.insert(make_pair(a1.<a class="code" href="classGMapping_1_1autoptr.html#aa641f3e33480944c12157ec2dbcfba43">m_reference</a>, 1));</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;                    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;                        f-&gt;second++;</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;                }</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;            }</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;        }</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;    }</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;    cerr &lt;&lt; __PRETTY_FUNCTION__ &lt;&lt;  <span class="stringliteral">&quot;: Number of allocated chunks&quot;</span> &lt;&lt; pmap.size() &lt;&lt; endl;</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;    <span class="keywordflow">for</span>(PointerMap::const_iterator it=pmap.begin(); it!=pmap.end(); it++)</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;        assert(it-&gt;first-&gt;shares==(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>)it-&gt;second);</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;    cerr &lt;&lt; __PRETTY_FUNCTION__ &lt;&lt;  <span class="stringliteral">&quot;: SUCCESS, the error is somewhere else&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;<span class="preprocessor"># endif</span></div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;<span class="preprocessor"></span>    <a class="code" href="classGMapping_1_1GridSlamProcessor.html">GridSlamProcessor</a>* cloned=<span class="keyword">new</span> <a class="code" href="classGMapping_1_1GridSlamProcessor.html#a736f647e15e7b3e5f853920beb7b2b80">GridSlamProcessor</a>(*<span class="keyword">this</span>);</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;<span class="preprocessor"># ifdef MAP_CONSISTENCY_CHECK</span></div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;<span class="preprocessor"></span>    cerr &lt;&lt; __PRETTY_FUNCTION__ &lt;&lt;  <span class="stringliteral">&quot;: trajectories end&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;    cerr &lt;&lt; __PRETTY_FUNCTION__ &lt;&lt; <span class="stringliteral">&quot;: performing afterclone_fit_test&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;    ParticleVector::const_iterator jt=cloned-&gt;<a class="code" href="classGMapping_1_1GridSlamProcessor.html#a67c2ade1a066269de12fe382999f2905">m_particles</a>.begin();</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;    <span class="keywordflow">for</span> (ParticleVector::const_iterator it=<a class="code" href="classGMapping_1_1GridSlamProcessor.html#a67c2ade1a066269de12fe382999f2905">m_particles</a>.begin(); it!=<a class="code" href="classGMapping_1_1GridSlamProcessor.html#a67c2ade1a066269de12fe382999f2905">m_particles</a>.end(); it++){</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;        <span class="keyword">const</span> <a class="code" href="classGMapping_1_1Map.html">ScanMatcherMap</a>&amp; m1(it-&gt;map);</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;        <span class="keyword">const</span> <a class="code" href="classGMapping_1_1Map.html">ScanMatcherMap</a>&amp; m2(jt-&gt;map);</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;        <span class="keyword">const</span> <a class="code" href="classGMapping_1_1HierarchicalArray2D.html">HierarchicalArray2D&lt;PointAccumulator&gt;</a>&amp; h1(m1.<a class="code" href="classGMapping_1_1Map.html#a8bc733ffc30a93d5ccc2d50fde1b0bcb">storage</a>());</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;        <span class="keyword">const</span> <a class="code" href="classGMapping_1_1HierarchicalArray2D.html">HierarchicalArray2D&lt;PointAccumulator&gt;</a>&amp; h2(m2.<a class="code" href="classGMapping_1_1Map.html#a8bc733ffc30a93d5ccc2d50fde1b0bcb">storage</a>());</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;        jt++;</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> x=0; x&lt;h1.getXSize(); x++){</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> y=0; y&lt;h1.getYSize(); y++){</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;                <span class="keyword">const</span> <a class="code" href="classGMapping_1_1autoptr.html">autoptr&lt; Array2D&lt;PointAccumulator&gt;</a> &gt;&amp; a1(h1.m_cells[x][y]);</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;                <span class="keyword">const</span> <a class="code" href="classGMapping_1_1autoptr.html">autoptr&lt; Array2D&lt;PointAccumulator&gt;</a> &gt;&amp; a2(h2.m_cells[x][y]);</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;                assert(a1.<a class="code" href="classGMapping_1_1autoptr.html#aa641f3e33480944c12157ec2dbcfba43">m_reference</a>==a2.<a class="code" href="classGMapping_1_1autoptr.html#aa641f3e33480944c12157ec2dbcfba43">m_reference</a>);</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;                assert((!a1.<a class="code" href="classGMapping_1_1autoptr.html#aa641f3e33480944c12157ec2dbcfba43">m_reference</a>) || !(a1.<a class="code" href="classGMapping_1_1autoptr.html#aa641f3e33480944c12157ec2dbcfba43">m_reference</a>-&gt;shares%2));</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;            }</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;        }</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;    }</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;    cerr &lt;&lt; __PRETTY_FUNCTION__ &lt;&lt;  <span class="stringliteral">&quot;: SUCCESS, the error is somewhere else&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;<span class="preprocessor"># endif</span></div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;<span class="preprocessor"></span>    <span class="keywordflow">return</span> cloned;</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;}</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;</div>
<div class="line"><a name="l00151"></a><span class="lineno"><a class="line" href="classGMapping_1_1GridSlamProcessor.html#a5cc821f920af1f0e5b6f6c06a5281d35">  151</a></span>&#160;<a class="code" href="classGMapping_1_1GridSlamProcessor.html#a5cc821f920af1f0e5b6f6c06a5281d35">GridSlamProcessor::~GridSlamProcessor</a>(){</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;    cerr &lt;&lt; __PRETTY_FUNCTION__ &lt;&lt; <span class="stringliteral">&quot;: Start&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;    cerr &lt;&lt; __PRETTY_FUNCTION__ &lt;&lt; <span class="stringliteral">&quot;: Deleting tree&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;    <span class="keywordflow">for</span> (std::vector&lt;Particle&gt;::iterator it=<a class="code" href="classGMapping_1_1GridSlamProcessor.html#a67c2ade1a066269de12fe382999f2905">m_particles</a>.begin(); it!=<a class="code" href="classGMapping_1_1GridSlamProcessor.html#a67c2ade1a066269de12fe382999f2905">m_particles</a>.end(); it++){</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;<span class="preprocessor">#ifdef TREE_CONSISTENCY_CHECK           </span></div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;<span class="preprocessor"></span>        <a class="code" href="structGMapping_1_1GridSlamProcessor_1_1TNode.html">TNode</a>* node=it-&gt;node;</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;        <span class="keywordflow">while</span>(node)</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;            node=node-&gt;<a class="code" href="structGMapping_1_1GridSlamProcessor_1_1TNode.html#aa96443473844405f417fb8170b3d7243">parent</a>;</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;        cerr &lt;&lt; <span class="stringliteral">&quot;@&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;<span class="preprocessor"></span>        <span class="keywordflow">if</span> (it-&gt;node)</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;            <span class="keyword">delete</span> it-&gt;node;</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;        <span class="comment">//cout &lt;&lt; &quot;l=&quot; &lt;&lt; it-&gt;weight&lt;&lt; endl;</span></div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;    }</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;    </div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;<span class="preprocessor"># ifdef MAP_CONSISTENCY_CHECK</span></div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;<span class="preprocessor"></span>    cerr &lt;&lt; __PRETTY_FUNCTION__ &lt;&lt; <span class="stringliteral">&quot;: performing predestruction_fit_test&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;    <span class="keyword">typedef</span> std::map&lt;autoptr&lt; Array2D&lt;PointAccumulator&gt; &gt;::reference* <span class="keyword">const</span>, <span class="keywordtype">int</span>&gt; PointerMap;</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;    PointerMap pmap;</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;    <span class="keywordflow">for</span> (ParticleVector::const_iterator it=<a class="code" href="classGMapping_1_1GridSlamProcessor.html#a67c2ade1a066269de12fe382999f2905">m_particles</a>.begin(); it!=<a class="code" href="classGMapping_1_1GridSlamProcessor.html#a67c2ade1a066269de12fe382999f2905">m_particles</a>.end(); it++){</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;        <span class="keyword">const</span> <a class="code" href="classGMapping_1_1Map.html">ScanMatcherMap</a>&amp; m1(it-&gt;map);</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;        <span class="keyword">const</span> <a class="code" href="classGMapping_1_1HierarchicalArray2D.html">HierarchicalArray2D&lt;PointAccumulator&gt;</a>&amp; h1(m1.<a class="code" href="classGMapping_1_1Map.html#a8bc733ffc30a93d5ccc2d50fde1b0bcb">storage</a>());</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> x=0; x&lt;h1.getXSize(); x++){</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> y=0; y&lt;h1.getYSize(); y++){</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;                <span class="keyword">const</span> <a class="code" href="classGMapping_1_1autoptr.html">autoptr&lt; Array2D&lt;PointAccumulator&gt;</a> &gt;&amp; a1(h1.m_cells[x][y]);</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;                <span class="keywordflow">if</span> (a1.<a class="code" href="classGMapping_1_1autoptr.html#aa641f3e33480944c12157ec2dbcfba43">m_reference</a>){</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;                    PointerMap::iterator f=pmap.find(a1.<a class="code" href="classGMapping_1_1autoptr.html#aa641f3e33480944c12157ec2dbcfba43">m_reference</a>);</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;                    <span class="keywordflow">if</span> (f==pmap.end())</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;                        pmap.insert(make_pair(a1.<a class="code" href="classGMapping_1_1autoptr.html#aa641f3e33480944c12157ec2dbcfba43">m_reference</a>, 1));</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;                    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;                        f-&gt;second++;</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;                }</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;            }</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;        }</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;    }</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;    cerr &lt;&lt; __PRETTY_FUNCTION__ &lt;&lt; <span class="stringliteral">&quot;: Number of allocated chunks&quot;</span> &lt;&lt; pmap.size() &lt;&lt; endl;</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;    <span class="keywordflow">for</span>(PointerMap::const_iterator it=pmap.begin(); it!=pmap.end(); it++)</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;        assert(it-&gt;first-&gt;shares&gt;=(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>)it-&gt;second);</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;    cerr &lt;&lt; __PRETTY_FUNCTION__ &lt;&lt; <span class="stringliteral">&quot;: SUCCESS, the error is somewhere else&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;<span class="preprocessor"># endif</span></div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;<span class="preprocessor"></span>}</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;</div>
<div class="line"><a name="l00195"></a><span class="lineno"><a class="line" href="classGMapping_1_1GridSlamProcessor.html#ac015894484817bd962b0990fa64abfe4">  195</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classGMapping_1_1GridSlamProcessor.html#ac015894484817bd962b0990fa64abfe4">GridSlamProcessor::setMatchingParameters</a> (<span class="keywordtype">double</span> urange, <span class="keywordtype">double</span> range, <span class="keywordtype">double</span> sigma, <span class="keywordtype">int</span> kernsize, <span class="keywordtype">double</span> lopt, <span class="keywordtype">double</span> aopt,</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;                                               <span class="keywordtype">int</span> iterations, <span class="keywordtype">double</span> likelihoodSigma, <span class="keywordtype">double</span> likelihoodGain, <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> likelihoodSkip){</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;    m_obsSigmaGain=likelihoodGain;</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;    <a class="code" href="classGMapping_1_1GridSlamProcessor.html#ac50952d259590c4aeba22eee4e6437f5">m_matcher</a>.<a class="code" href="classGMapping_1_1ScanMatcher.html#aad081e39e5629e1532af566370b842fb">setMatchingParameters</a>(urange, range, sigma, kernsize, lopt, aopt, iterations, likelihoodSigma, likelihoodSkip);</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classGMapping_1_1GridSlamProcessor.html#a7ad909f978d96737b5a336a15c65384c">m_infoStream</a>)</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;        <a class="code" href="classGMapping_1_1GridSlamProcessor.html#a7ad909f978d96737b5a336a15c65384c">m_infoStream</a> &lt;&lt; <span class="stringliteral">&quot; -maxUrange &quot;</span>&lt;&lt; urange</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;                     &lt;&lt; <span class="stringliteral">&quot; -maxUrange &quot;</span>&lt;&lt; range</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;                     &lt;&lt; <span class="stringliteral">&quot; -sigma     &quot;</span>&lt;&lt; sigma</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;                     &lt;&lt; <span class="stringliteral">&quot; -kernelSize &quot;</span>&lt;&lt; kernsize</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;                     &lt;&lt; <span class="stringliteral">&quot; -lstep &quot;</span>    &lt;&lt; lopt</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;                     &lt;&lt; <span class="stringliteral">&quot; -lobsGain &quot;</span> &lt;&lt; m_obsSigmaGain</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;                     &lt;&lt; <span class="stringliteral">&quot; -astep &quot;</span>    &lt;&lt; aopt &lt;&lt; endl;</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;    </div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;    </div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;}</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;<span class="keywordtype">void</span> <a class="code" href="classGMapping_1_1GridSlamProcessor.html#af5c4b7f2992f1d11b2e373dbd410cab2">GridSlamProcessor::setMotionModelParameters</a></div>
<div class="line"><a name="l00212"></a><span class="lineno"><a class="line" href="classGMapping_1_1GridSlamProcessor.html#af5c4b7f2992f1d11b2e373dbd410cab2">  212</a></span>&#160;(<span class="keywordtype">double</span> srr, <span class="keywordtype">double</span> srt, <span class="keywordtype">double</span> str, <span class="keywordtype">double</span> stt){</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;    m_motionModel.srr=srr;</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;    m_motionModel.srt=srt;</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;    m_motionModel.str=str;</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;    m_motionModel.stt=stt;</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;    <span class="keywordflow">if</span> (m_infoStream)</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;        m_infoStream &lt;&lt; <span class="stringliteral">&quot; -srr &quot;</span>&lt;&lt; srr  &lt;&lt; <span class="stringliteral">&quot; -srt &quot;</span>&lt;&lt; srt</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;                     &lt;&lt; <span class="stringliteral">&quot; -str &quot;</span>&lt;&lt; str  &lt;&lt; <span class="stringliteral">&quot; -stt &quot;</span>&lt;&lt; stt &lt;&lt; endl;</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;}</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;</div>
<div class="line"><a name="l00224"></a><span class="lineno"><a class="line" href="classGMapping_1_1GridSlamProcessor.html#a82a12db62b99cf2f0cd3f475c81af77f">  224</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classGMapping_1_1GridSlamProcessor.html#a82a12db62b99cf2f0cd3f475c81af77f">GridSlamProcessor::setUpdateDistances</a>(<span class="keywordtype">double</span> linear, <span class="keywordtype">double</span> angular, <span class="keywordtype">double</span> resampleThreshold){</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;    m_linearThresholdDistance=linear;</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;    m_angularThresholdDistance=angular;</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;    m_resampleThreshold=resampleThreshold;</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classGMapping_1_1GridSlamProcessor.html#a7ad909f978d96737b5a336a15c65384c">m_infoStream</a>)</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;        <a class="code" href="classGMapping_1_1GridSlamProcessor.html#a7ad909f978d96737b5a336a15c65384c">m_infoStream</a> &lt;&lt; <span class="stringliteral">&quot; -linearUpdate &quot;</span> &lt;&lt; linear</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;                     &lt;&lt; <span class="stringliteral">&quot; -angularUpdate &quot;</span>&lt;&lt; angular</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;                     &lt;&lt; <span class="stringliteral">&quot; -resampleThreshold &quot;</span> &lt;&lt; m_resampleThreshold &lt;&lt; endl;</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;}</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;<span class="comment">//HERE STARTS THE BEEF</span></div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;</div>
<div class="line"><a name="l00236"></a><span class="lineno"><a class="line" href="structGMapping_1_1GridSlamProcessor_1_1Particle.html#a51dc73563ad5e3035f8cb3b51965854a">  236</a></span>&#160;<a class="code" href="structGMapping_1_1GridSlamProcessor_1_1Particle.html#a51dc73563ad5e3035f8cb3b51965854a">GridSlamProcessor::Particle::Particle</a>(<span class="keyword">const</span> <a class="code" href="classGMapping_1_1Map.html">ScanMatcherMap</a>&amp; m):</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;    map(m), pose(0,0,0), weight(0), weightSum(0), gweight(0), previousIndex(0){</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;    <a class="code" href="structGMapping_1_1GridSlamProcessor_1_1Particle.html#a9c91ccdf7009b50785d939e1791ae4be">node</a>=0;</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;}</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;</div>
<div class="line"><a name="l00242"></a><span class="lineno"><a class="line" href="classGMapping_1_1GridSlamProcessor.html#a4277d04a56f1d03deecddcd3f62bf58d">  242</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classGMapping_1_1GridSlamProcessor.html#a4277d04a56f1d03deecddcd3f62bf58d">GridSlamProcessor::setSensorMap</a>(<span class="keyword">const</span> <a class="code" href="namespaceGMapping.html#af37440197d6baeaaf592e4980218742b">SensorMap</a>&amp; smap){</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;    </div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;    <span class="comment">/*</span></div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;<span class="comment">      Construct the angle table for the sensor</span></div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;<span class="comment">      </span></div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;<span class="comment">      FIXME For now detect the readings of only the front laser, and assume its pose is in the center of the robot</span></div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;<span class="comment">    */</span></div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;    </div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;    SensorMap::const_iterator laser_it=smap.find(std::string(<span class="stringliteral">&quot;FLASER&quot;</span>));</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;    <span class="keywordflow">if</span> (laser_it==smap.end()){</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;        cerr &lt;&lt; <span class="stringliteral">&quot;Attempting to load the new carmen log format&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;        laser_it=smap.find(std::string(<span class="stringliteral">&quot;ROBOTLASER1&quot;</span>));</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;        assert(laser_it!=smap.end());</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;    }</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;    <span class="keyword">const</span> <a class="code" href="classGMapping_1_1RangeSensor.html">RangeSensor</a>* rangeSensor=<span class="keyword">dynamic_cast&lt;</span><span class="keyword">const </span><a class="code" href="classGMapping_1_1RangeSensor.html">RangeSensor</a>*<span class="keyword">&gt;</span>((laser_it-&gt;second));</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;    assert(rangeSensor &amp;&amp; rangeSensor-&gt;<a class="code" href="classGMapping_1_1RangeSensor.html#ac2cd935c61dc0c7158b0a7f6d00b150c">beams</a>().size());</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;    </div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;    <a class="code" href="classGMapping_1_1GridSlamProcessor.html#aec30b4ee3a767c9f50bb95236851a1be">m_beams</a>=<span class="keyword">static_cast&lt;</span><span class="keywordtype">unsigned</span> <span class="keywordtype">int</span><span class="keyword">&gt;</span>(rangeSensor-&gt;<a class="code" href="classGMapping_1_1RangeSensor.html#ac2cd935c61dc0c7158b0a7f6d00b150c">beams</a>().size());</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;    <span class="keywordtype">double</span>* angles=<span class="keyword">new</span> <span class="keywordtype">double</span>[rangeSensor-&gt;<a class="code" href="classGMapping_1_1RangeSensor.html#ac2cd935c61dc0c7158b0a7f6d00b150c">beams</a>().size()];</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i=0; i&lt;<a class="code" href="classGMapping_1_1GridSlamProcessor.html#aec30b4ee3a767c9f50bb95236851a1be">m_beams</a>; i++){</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;        angles[i]=rangeSensor-&gt;<a class="code" href="classGMapping_1_1RangeSensor.html#ac2cd935c61dc0c7158b0a7f6d00b150c">beams</a>()[i].pose.theta;</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;    }</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;    <a class="code" href="classGMapping_1_1GridSlamProcessor.html#ac50952d259590c4aeba22eee4e6437f5">m_matcher</a>.<a class="code" href="classGMapping_1_1ScanMatcher.html#a64191c56d4fd0dedea13acf4228fb3d7">setLaserParameters</a>(m_beams, angles, rangeSensor-&gt;<a class="code" href="classGMapping_1_1RangeSensor.html#ae94a67c529c644d4193a15da20bf9615">getPose</a>());</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;    <span class="keyword">delete</span> [] angles;</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;}</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;</div>
<div class="line"><a name="l00268"></a><span class="lineno"><a class="line" href="classGMapping_1_1GridSlamProcessor.html#a0993feeb34469143808a6ff2d9d1ae6b">  268</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classGMapping_1_1GridSlamProcessor.html#a0993feeb34469143808a6ff2d9d1ae6b">GridSlamProcessor::init</a>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> size, <span class="keywordtype">double</span> xmin, <span class="keywordtype">double</span> ymin, <span class="keywordtype">double</span> xmax, <span class="keywordtype">double</span> ymax, <span class="keywordtype">double</span> <a class="code" href="gfs2stream_8cpp.html#a704f8c0bba2b3eb047aa1f950ea31c85">delta</a>, <a class="code" href="structGMapping_1_1orientedpoint.html">OrientedPoint</a> initialPose){</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;    m_xmin=xmin;</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;    m_ymin=ymin;</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;    m_xmax=xmax;</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;    m_ymax=ymax;</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;    m_delta=<a class="code" href="gfs2stream_8cpp.html#a704f8c0bba2b3eb047aa1f950ea31c85">delta</a>;</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classGMapping_1_1GridSlamProcessor.html#a7ad909f978d96737b5a336a15c65384c">m_infoStream</a>)</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;        <a class="code" href="classGMapping_1_1GridSlamProcessor.html#a7ad909f978d96737b5a336a15c65384c">m_infoStream</a></div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;                &lt;&lt; <span class="stringliteral">&quot; -xmin &quot;</span>&lt;&lt; m_xmin</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;                &lt;&lt; <span class="stringliteral">&quot; -xmax &quot;</span>&lt;&lt; m_xmax</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;                &lt;&lt; <span class="stringliteral">&quot; -ymin &quot;</span>&lt;&lt; m_ymin</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;                &lt;&lt; <span class="stringliteral">&quot; -ymax &quot;</span>&lt;&lt; m_ymax</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;                &lt;&lt; <span class="stringliteral">&quot; -delta &quot;</span>&lt;&lt; m_delta</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;                &lt;&lt; <span class="stringliteral">&quot; -particles &quot;</span>&lt;&lt; size &lt;&lt; endl;</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;    </div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;    <a class="code" href="classGMapping_1_1GridSlamProcessor.html#a67c2ade1a066269de12fe382999f2905">m_particles</a>.clear();</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;    <a class="code" href="structGMapping_1_1GridSlamProcessor_1_1TNode.html">TNode</a>* node=<span class="keyword">new</span> <a class="code" href="structGMapping_1_1GridSlamProcessor_1_1TNode.html">TNode</a>(initialPose, 0, 0, 0);</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;    <a class="code" href="classGMapping_1_1Map.html">ScanMatcherMap</a> lmap(<a class="code" href="namespaceGMapping.html#a02aca97274c6c5fe90097e517f88493d">Point</a>(xmin+xmax, ymin+ymax)*.5, xmax-xmin, ymax-ymin, delta);</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i=0; i&lt;size; i++){</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;        <a class="code" href="classGMapping_1_1GridSlamProcessor.html#a67c2ade1a066269de12fe382999f2905">m_particles</a>.push_back(<a class="code" href="structGMapping_1_1GridSlamProcessor_1_1Particle.html">Particle</a>(lmap));</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;        <a class="code" href="classGMapping_1_1GridSlamProcessor.html#a67c2ade1a066269de12fe382999f2905">m_particles</a>.back().pose=initialPose;</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;        <a class="code" href="classGMapping_1_1GridSlamProcessor.html#a67c2ade1a066269de12fe382999f2905">m_particles</a>.back().previousPose=initialPose;</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;        <a class="code" href="classGMapping_1_1GridSlamProcessor.html#a67c2ade1a066269de12fe382999f2905">m_particles</a>.back().setWeight(0);</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;        <a class="code" href="classGMapping_1_1GridSlamProcessor.html#a67c2ade1a066269de12fe382999f2905">m_particles</a>.back().previousIndex=0;</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;        <span class="comment">// this is not needed</span></div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;        <span class="comment">//              m_particles.back().node=new TNode(initialPose, 0, node, 0);</span></div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;        <span class="comment">// we use the root directly</span></div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;        <a class="code" href="classGMapping_1_1GridSlamProcessor.html#a67c2ade1a066269de12fe382999f2905">m_particles</a>.back().node= node;</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;    }</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;    m_neff=(double)size;</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;    <a class="code" href="classGMapping_1_1GridSlamProcessor.html#a1c7e0a4fec2a31769f27fd17a9cfac3d">m_count</a>=0;</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;    <a class="code" href="classGMapping_1_1GridSlamProcessor.html#a50a21e3936bb5c122a9e4b8039be9bc9">m_readingCount</a>=0;</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;    <a class="code" href="classGMapping_1_1GridSlamProcessor.html#a94ba410742ad6712b707e908e53da5e1">m_linearDistance</a>=<a class="code" href="classGMapping_1_1GridSlamProcessor.html#aeede1ad148cba7c6080da5d8f00d4ac6">m_angularDistance</a>=0;</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;}</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;</div>
<div class="line"><a name="l00306"></a><span class="lineno"><a class="line" href="classGMapping_1_1GridSlamProcessor.html#ae95960a9452ea93a6002a92ff8cd4777">  306</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classGMapping_1_1GridSlamProcessor.html#ae95960a9452ea93a6002a92ff8cd4777">GridSlamProcessor::processTruePos</a>(<span class="keyword">const</span> <a class="code" href="classGMapping_1_1OdometryReading.html">OdometryReading</a>&amp; o){</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;    <span class="keyword">const</span> <a class="code" href="classGMapping_1_1OdometrySensor.html">OdometrySensor</a>* os=<span class="keyword">dynamic_cast&lt;</span><span class="keyword">const </span><a class="code" href="classGMapping_1_1OdometrySensor.html">OdometrySensor</a>*<span class="keyword">&gt;</span>(o.<a class="code" href="classGMapping_1_1SensorReading.html#a7d074969806f41aa6971f44f043f6c9c">getSensor</a>());</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;    <span class="keywordflow">if</span> (os &amp;&amp; os-&gt;<a class="code" href="classGMapping_1_1OdometrySensor.html#a3454b256a55d2176132939a6842aa873">isIdeal</a>() &amp;&amp; <a class="code" href="classGMapping_1_1GridSlamProcessor.html#a25d322edaf8cdbc585493934918b3a6a">m_outputStream</a>){</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;        <a class="code" href="classGMapping_1_1GridSlamProcessor.html#a25d322edaf8cdbc585493934918b3a6a">m_outputStream</a> &lt;&lt; setiosflags(ios::fixed) &lt;&lt; setprecision(3);</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;        <a class="code" href="classGMapping_1_1GridSlamProcessor.html#a25d322edaf8cdbc585493934918b3a6a">m_outputStream</a> &lt;&lt;  <span class="stringliteral">&quot;SIMULATOR_POS &quot;</span> &lt;&lt;  o.<a class="code" href="classGMapping_1_1OdometryReading.html#a42e7772cdb3724a43ed1a2fb0d27c15b">getPose</a>().<a class="code" href="structGMapping_1_1point.html#a1e3816abbc8b56607fa741952fe74a8c">x</a> &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; o.<a class="code" href="classGMapping_1_1OdometryReading.html#a42e7772cdb3724a43ed1a2fb0d27c15b">getPose</a>().<a class="code" href="structGMapping_1_1point.html#ae25e311e074409d6329c2e66741006f1">y</a> &lt;&lt; <span class="stringliteral">&quot; &quot;</span> ;</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;        <a class="code" href="classGMapping_1_1GridSlamProcessor.html#a25d322edaf8cdbc585493934918b3a6a">m_outputStream</a> &lt;&lt; setiosflags(ios::fixed) &lt;&lt; setprecision(6) &lt;&lt; o.<a class="code" href="classGMapping_1_1OdometryReading.html#a42e7772cdb3724a43ed1a2fb0d27c15b">getPose</a>().<a class="code" href="structGMapping_1_1orientedpoint.html#a610fdfefb42f5c836de7ab9e94ba11d0">theta</a> &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt;  o.<a class="code" href="classGMapping_1_1SensorReading.html#a54617dbdded28a4162d1b7f73e12adc3">getTime</a>() &lt;&lt; endl;</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;    }</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;}</div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;</div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;</div>
<div class="line"><a name="l00316"></a><span class="lineno"><a class="line" href="classGMapping_1_1GridSlamProcessor.html#a34c7f216947ee4c8ac05d5a53366aa5d">  316</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="classGMapping_1_1GridSlamProcessor.html#a34c7f216947ee4c8ac05d5a53366aa5d">GridSlamProcessor::processScan</a>(<span class="keyword">const</span> <a class="code" href="classGMapping_1_1RangeReading.html">RangeReading</a> &amp; reading, <span class="keywordtype">int</span> adaptParticles){<span class="comment">//adaptParticles default 0</span></div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;    </div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;    <a class="code" href="structGMapping_1_1orientedpoint.html">OrientedPoint</a> relPose=reading.<a class="code" href="classGMapping_1_1RangeReading.html#a7f8c2ac4de3d9e67d671c76dc4932f13">getPose</a>();  <span class="comment">//  centered_laser_pose_在odom_frame_的表示</span></div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="classGMapping_1_1GridSlamProcessor.html#a1c7e0a4fec2a31769f27fd17a9cfac3d">m_count</a>){</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;        <a class="code" href="classGMapping_1_1GridSlamProcessor.html#aeddf8ebf9784e818d93a4c5bb94e3c0d">m_lastPartPose</a>=<a class="code" href="classGMapping_1_1GridSlamProcessor.html#a242df41618ccce684a01229c3c752dc9">m_odoPose</a>=relPose;</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;    }</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;    </div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;    <span class="comment">//write the state of the reading and update all the particles using the motion model</span></div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;    <span class="keywordflow">for</span> (ParticleVector::iterator it=<a class="code" href="classGMapping_1_1GridSlamProcessor.html#a67c2ade1a066269de12fe382999f2905">m_particles</a>.begin(); it!=<a class="code" href="classGMapping_1_1GridSlamProcessor.html#a67c2ade1a066269de12fe382999f2905">m_particles</a>.end(); it++){</div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;        <a class="code" href="structGMapping_1_1orientedpoint.html">OrientedPoint</a>&amp; pose(it-&gt;pose);</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;        pose=<a class="code" href="classGMapping_1_1GridSlamProcessor.html#ae1fa20e9679abdbc23784e2dc17194b5">m_motionModel</a>.<a class="code" href="structGMapping_1_1MotionModel.html#a52f6588b043916025f7f6bd760cf947a">drawFromMotion</a>(it-&gt;pose, relPose, <a class="code" href="classGMapping_1_1GridSlamProcessor.html#a242df41618ccce684a01229c3c752dc9">m_odoPose</a>);</div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;    }</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;    <span class="comment">// update the output file</span></div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classGMapping_1_1GridSlamProcessor.html#a25d322edaf8cdbc585493934918b3a6a">m_outputStream</a>.is_open()){</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;        <a class="code" href="classGMapping_1_1GridSlamProcessor.html#a25d322edaf8cdbc585493934918b3a6a">m_outputStream</a> &lt;&lt; setiosflags(ios::fixed) &lt;&lt; setprecision(6);</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;        <a class="code" href="classGMapping_1_1GridSlamProcessor.html#a25d322edaf8cdbc585493934918b3a6a">m_outputStream</a> &lt;&lt; <span class="stringliteral">&quot;ODOM &quot;</span>;</div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;        <a class="code" href="classGMapping_1_1GridSlamProcessor.html#a25d322edaf8cdbc585493934918b3a6a">m_outputStream</a> &lt;&lt; setiosflags(ios::fixed) &lt;&lt; setprecision(3) &lt;&lt; <a class="code" href="classGMapping_1_1GridSlamProcessor.html#a242df41618ccce684a01229c3c752dc9">m_odoPose</a>.<a class="code" href="structGMapping_1_1point.html#a1e3816abbc8b56607fa741952fe74a8c">x</a> &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; <a class="code" href="classGMapping_1_1GridSlamProcessor.html#a242df41618ccce684a01229c3c752dc9">m_odoPose</a>.<a class="code" href="structGMapping_1_1point.html#ae25e311e074409d6329c2e66741006f1">y</a> &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;</div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;        <a class="code" href="classGMapping_1_1GridSlamProcessor.html#a25d322edaf8cdbc585493934918b3a6a">m_outputStream</a> &lt;&lt; setiosflags(ios::fixed) &lt;&lt; setprecision(6) &lt;&lt; <a class="code" href="classGMapping_1_1GridSlamProcessor.html#a242df41618ccce684a01229c3c752dc9">m_odoPose</a>.<a class="code" href="structGMapping_1_1orientedpoint.html#a610fdfefb42f5c836de7ab9e94ba11d0">theta</a> &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;</div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;        <a class="code" href="classGMapping_1_1GridSlamProcessor.html#a25d322edaf8cdbc585493934918b3a6a">m_outputStream</a> &lt;&lt; reading.<a class="code" href="classGMapping_1_1SensorReading.html#a54617dbdded28a4162d1b7f73e12adc3">getTime</a>();</div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;        <a class="code" href="classGMapping_1_1GridSlamProcessor.html#a25d322edaf8cdbc585493934918b3a6a">m_outputStream</a> &lt;&lt; endl;</div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;    }</div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classGMapping_1_1GridSlamProcessor.html#a25d322edaf8cdbc585493934918b3a6a">m_outputStream</a>.is_open()){</div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;        <a class="code" href="classGMapping_1_1GridSlamProcessor.html#a25d322edaf8cdbc585493934918b3a6a">m_outputStream</a> &lt;&lt; setiosflags(ios::fixed) &lt;&lt; setprecision(6);</div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;        <a class="code" href="classGMapping_1_1GridSlamProcessor.html#a25d322edaf8cdbc585493934918b3a6a">m_outputStream</a> &lt;&lt; <span class="stringliteral">&quot;ODO_UPDATE &quot;</span>&lt;&lt; <a class="code" href="classGMapping_1_1GridSlamProcessor.html#a67c2ade1a066269de12fe382999f2905">m_particles</a>.size() &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;        <span class="keywordflow">for</span> (ParticleVector::iterator it=<a class="code" href="classGMapping_1_1GridSlamProcessor.html#a67c2ade1a066269de12fe382999f2905">m_particles</a>.begin(); it!=<a class="code" href="classGMapping_1_1GridSlamProcessor.html#a67c2ade1a066269de12fe382999f2905">m_particles</a>.end(); it++){</div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;            <a class="code" href="structGMapping_1_1orientedpoint.html">OrientedPoint</a>&amp; pose(it-&gt;pose);</div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;            <a class="code" href="classGMapping_1_1GridSlamProcessor.html#a25d322edaf8cdbc585493934918b3a6a">m_outputStream</a> &lt;&lt; setiosflags(ios::fixed) &lt;&lt; setprecision(3) &lt;&lt; pose.<a class="code" href="structGMapping_1_1point.html#a1e3816abbc8b56607fa741952fe74a8c">x</a> &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; pose.<a class="code" href="structGMapping_1_1point.html#ae25e311e074409d6329c2e66741006f1">y</a> &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;            <a class="code" href="classGMapping_1_1GridSlamProcessor.html#a25d322edaf8cdbc585493934918b3a6a">m_outputStream</a> &lt;&lt; setiosflags(ios::fixed) &lt;&lt; setprecision(6) &lt;&lt; pose.<a class="code" href="structGMapping_1_1orientedpoint.html#a610fdfefb42f5c836de7ab9e94ba11d0">theta</a> &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; it-&gt; weight &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;        }</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;        <a class="code" href="classGMapping_1_1GridSlamProcessor.html#a25d322edaf8cdbc585493934918b3a6a">m_outputStream</a> &lt;&lt; reading.<a class="code" href="classGMapping_1_1SensorReading.html#a54617dbdded28a4162d1b7f73e12adc3">getTime</a>();</div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;        <a class="code" href="classGMapping_1_1GridSlamProcessor.html#a25d322edaf8cdbc585493934918b3a6a">m_outputStream</a> &lt;&lt; endl;</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;    }</div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;    </div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;    <span class="comment">//invoke the callback</span></div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;    <a class="code" href="classGMapping_1_1GridSlamProcessor.html#a2d39e20b20691b27676d36273b91a69e">onOdometryUpdate</a>();</div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;    </div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;</div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;    <span class="comment">// accumulate the robot translation and rotation</span></div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;    <a class="code" href="structGMapping_1_1orientedpoint.html">OrientedPoint</a> move=relPose-<a class="code" href="classGMapping_1_1GridSlamProcessor.html#a242df41618ccce684a01229c3c752dc9">m_odoPose</a>;</div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;    move.<a class="code" href="structGMapping_1_1orientedpoint.html#a610fdfefb42f5c836de7ab9e94ba11d0">theta</a>=atan2(sin(move.<a class="code" href="structGMapping_1_1orientedpoint.html#a610fdfefb42f5c836de7ab9e94ba11d0">theta</a>), cos(move.<a class="code" href="structGMapping_1_1orientedpoint.html#a610fdfefb42f5c836de7ab9e94ba11d0">theta</a>));</div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;    <a class="code" href="classGMapping_1_1GridSlamProcessor.html#a94ba410742ad6712b707e908e53da5e1">m_linearDistance</a>+=sqrt(move*move);</div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;    <a class="code" href="classGMapping_1_1GridSlamProcessor.html#aeede1ad148cba7c6080da5d8f00d4ac6">m_angularDistance</a>+=fabs(move.theta);</div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;    </div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;    <span class="comment">// if the robot jumps throw a warning  估计的运动量过大</span></div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classGMapping_1_1GridSlamProcessor.html#a94ba410742ad6712b707e908e53da5e1">m_linearDistance</a>&gt;<a class="code" href="namespaceGMapping.html#a907bba3f1a2120b0374630ebf6101d5a">m_distanceThresholdCheck</a>){</div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;        cerr &lt;&lt; <span class="stringliteral">&quot;***********************************************************************&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;        cerr &lt;&lt; <span class="stringliteral">&quot;********** Error: m_distanceThresholdCheck overridden!!!! *************&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;        cerr &lt;&lt; <span class="stringliteral">&quot;m_distanceThresholdCheck=&quot;</span> &lt;&lt; <a class="code" href="namespaceGMapping.html#a907bba3f1a2120b0374630ebf6101d5a">m_distanceThresholdCheck</a> &lt;&lt; endl;</div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;        cerr &lt;&lt; <span class="stringliteral">&quot;Old Odometry Pose= &quot;</span> &lt;&lt; m_odoPose.x &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; m_odoPose.y</div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;             &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt;m_odoPose.theta &lt;&lt; endl;</div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;        cerr &lt;&lt; <span class="stringliteral">&quot;New Odometry Pose (reported from observation)= &quot;</span> &lt;&lt; relPose.<a class="code" href="structGMapping_1_1point.html#a1e3816abbc8b56607fa741952fe74a8c">x</a> &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; relPose.<a class="code" href="structGMapping_1_1point.html#ae25e311e074409d6329c2e66741006f1">y</a></div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;             &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt;relPose.<a class="code" href="structGMapping_1_1orientedpoint.html#a610fdfefb42f5c836de7ab9e94ba11d0">theta</a> &lt;&lt; endl;</div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;        cerr &lt;&lt; <span class="stringliteral">&quot;***********************************************************************&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;        cerr &lt;&lt; <span class="stringliteral">&quot;** The Odometry has a big jump here. This is probably a bug in the   **&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;        cerr &lt;&lt; <span class="stringliteral">&quot;** odometry/laser input. We continue now, but the result is probably **&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;        cerr &lt;&lt; <span class="stringliteral">&quot;** crap or can lead to a core dump since the map doesn&#39;t fit.... C&amp;G **&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;        cerr &lt;&lt; <span class="stringliteral">&quot;***********************************************************************&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;    }</div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;    </div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;    m_odoPose=relPose;</div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;    </div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;    <span class="keywordtype">bool</span> processed=<span class="keyword">false</span>;</div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;</div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;    <span class="comment">// process a scan only if the robot has traveled a given distance or a certain amount of time has elapsed</span></div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;    <span class="keywordflow">if</span> (! <a class="code" href="classGMapping_1_1GridSlamProcessor.html#a1c7e0a4fec2a31769f27fd17a9cfac3d">m_count</a></div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;            || <a class="code" href="classGMapping_1_1GridSlamProcessor.html#a94ba410742ad6712b707e908e53da5e1">m_linearDistance</a>&gt;=m_linearThresholdDistance   <span class="comment">//** 相邻转移量？？</span></div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;            || <a class="code" href="classGMapping_1_1GridSlamProcessor.html#aeede1ad148cba7c6080da5d8f00d4ac6">m_angularDistance</a>&gt;=m_angularThresholdDistance</div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;            || (<a class="code" href="classGMapping_1_1GridSlamProcessor.html#a83d163ab15cf15856ea69507ec87904a">period_</a> &gt;= 0.0 &amp;&amp; (reading.<a class="code" href="classGMapping_1_1SensorReading.html#a54617dbdded28a4162d1b7f73e12adc3">getTime</a>() - <a class="code" href="classGMapping_1_1GridSlamProcessor.html#a3f40a117057427e725aa92739dbe2480">last_update_time_</a>) &gt; <a class="code" href="classGMapping_1_1GridSlamProcessor.html#a83d163ab15cf15856ea69507ec87904a">period_</a>))</div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;    {</div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;        <a class="code" href="classGMapping_1_1GridSlamProcessor.html#a3f40a117057427e725aa92739dbe2480">last_update_time_</a> = reading.<a class="code" href="classGMapping_1_1SensorReading.html#a54617dbdded28a4162d1b7f73e12adc3">getTime</a>();</div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;</div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classGMapping_1_1GridSlamProcessor.html#a25d322edaf8cdbc585493934918b3a6a">m_outputStream</a>.is_open()){</div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;            <a class="code" href="classGMapping_1_1GridSlamProcessor.html#a25d322edaf8cdbc585493934918b3a6a">m_outputStream</a> &lt;&lt; setiosflags(ios::fixed) &lt;&lt; setprecision(6);</div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;            <a class="code" href="classGMapping_1_1GridSlamProcessor.html#a25d322edaf8cdbc585493934918b3a6a">m_outputStream</a> &lt;&lt; <span class="stringliteral">&quot;FRAME &quot;</span> &lt;&lt;  <a class="code" href="classGMapping_1_1GridSlamProcessor.html#a50a21e3936bb5c122a9e4b8039be9bc9">m_readingCount</a>;</div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;            <a class="code" href="classGMapping_1_1GridSlamProcessor.html#a25d322edaf8cdbc585493934918b3a6a">m_outputStream</a> &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; <a class="code" href="classGMapping_1_1GridSlamProcessor.html#a94ba410742ad6712b707e908e53da5e1">m_linearDistance</a>;</div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;            <a class="code" href="classGMapping_1_1GridSlamProcessor.html#a25d322edaf8cdbc585493934918b3a6a">m_outputStream</a> &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; <a class="code" href="classGMapping_1_1GridSlamProcessor.html#aeede1ad148cba7c6080da5d8f00d4ac6">m_angularDistance</a> &lt;&lt; endl;</div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;        }</div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;</div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classGMapping_1_1GridSlamProcessor.html#a7ad909f978d96737b5a336a15c65384c">m_infoStream</a>)</div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;            <a class="code" href="classGMapping_1_1GridSlamProcessor.html#a7ad909f978d96737b5a336a15c65384c">m_infoStream</a> &lt;&lt; <span class="stringliteral">&quot;update frame &quot;</span> &lt;&lt;  <a class="code" href="classGMapping_1_1GridSlamProcessor.html#a50a21e3936bb5c122a9e4b8039be9bc9">m_readingCount</a> &lt;&lt; endl</div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;                         &lt;&lt; <span class="stringliteral">&quot;update ld=&quot;</span> &lt;&lt; <a class="code" href="classGMapping_1_1GridSlamProcessor.html#a94ba410742ad6712b707e908e53da5e1">m_linearDistance</a> &lt;&lt; <span class="stringliteral">&quot; ad=&quot;</span> &lt;&lt; <a class="code" href="classGMapping_1_1GridSlamProcessor.html#aeede1ad148cba7c6080da5d8f00d4ac6">m_angularDistance</a> &lt;&lt; endl;</div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;</div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;</div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;        cerr &lt;&lt; <span class="stringliteral">&quot;Laser Pose= &quot;</span> &lt;&lt; reading.<a class="code" href="classGMapping_1_1RangeReading.html#a7f8c2ac4de3d9e67d671c76dc4932f13">getPose</a>().<a class="code" href="structGMapping_1_1point.html#a1e3816abbc8b56607fa741952fe74a8c">x</a> &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; reading.<a class="code" href="classGMapping_1_1RangeReading.html#a7f8c2ac4de3d9e67d671c76dc4932f13">getPose</a>().<a class="code" href="structGMapping_1_1point.html#ae25e311e074409d6329c2e66741006f1">y</a></div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;             &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; reading.<a class="code" href="classGMapping_1_1RangeReading.html#a7f8c2ac4de3d9e67d671c76dc4932f13">getPose</a>().<a class="code" href="structGMapping_1_1orientedpoint.html#a610fdfefb42f5c836de7ab9e94ba11d0">theta</a> &lt;&lt; endl;</div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;</div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;</div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;        <span class="comment">//this is for converting the reading in a scan-matcher feedable form</span></div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;        assert(reading.size()==<a class="code" href="classGMapping_1_1GridSlamProcessor.html#aec30b4ee3a767c9f50bb95236851a1be">m_beams</a>);</div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;        <span class="keywordtype">double</span> * plainReading = <span class="keyword">new</span> <span class="keywordtype">double</span>[<a class="code" href="classGMapping_1_1GridSlamProcessor.html#aec30b4ee3a767c9f50bb95236851a1be">m_beams</a>];</div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;        <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i=0; i&lt;<a class="code" href="classGMapping_1_1GridSlamProcessor.html#aec30b4ee3a767c9f50bb95236851a1be">m_beams</a>; i++)</div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;        {</div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;            plainReading[i]=reading[i];</div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;        }</div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;        <a class="code" href="classGMapping_1_1GridSlamProcessor.html#a7ad909f978d96737b5a336a15c65384c">m_infoStream</a> &lt;&lt; <span class="stringliteral">&quot;m_count &quot;</span> &lt;&lt; <a class="code" href="classGMapping_1_1GridSlamProcessor.html#a1c7e0a4fec2a31769f27fd17a9cfac3d">m_count</a> &lt;&lt; endl;</div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;</div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;        <a class="code" href="classGMapping_1_1RangeReading.html">RangeReading</a>* reading_copy =</div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;                <span class="keyword">new</span> <a class="code" href="classGMapping_1_1RangeReading.html">RangeReading</a>(reading.size(),</div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;                                 &amp;(reading[0]),</div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;                static_cast&lt;const RangeSensor*&gt;(reading.<a class="code" href="classGMapping_1_1SensorReading.html#a7d074969806f41aa6971f44f043f6c9c">getSensor</a>()),</div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;                reading.<a class="code" href="classGMapping_1_1SensorReading.html#a54617dbdded28a4162d1b7f73e12adc3">getTime</a>());</div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;</div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classGMapping_1_1GridSlamProcessor.html#a1c7e0a4fec2a31769f27fd17a9cfac3d">m_count</a>&gt;0)   <span class="comment">//scanMatch*******************************</span></div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;        {</div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;            <a class="code" href="classGMapping_1_1GridSlamProcessor.html#aff434850cc82667bcd4740d50ae60755">scanMatch</a>(plainReading);  <span class="comment">//优化算法调整粒子的位置，同时进行权重更新</span></div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="classGMapping_1_1GridSlamProcessor.html#a25d322edaf8cdbc585493934918b3a6a">m_outputStream</a>.is_open()){</div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;                <a class="code" href="classGMapping_1_1GridSlamProcessor.html#a25d322edaf8cdbc585493934918b3a6a">m_outputStream</a> &lt;&lt; <span class="stringliteral">&quot;LASER_READING &quot;</span>&lt;&lt; reading.size() &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;</div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;                <a class="code" href="classGMapping_1_1GridSlamProcessor.html#a25d322edaf8cdbc585493934918b3a6a">m_outputStream</a> &lt;&lt; setiosflags(ios::fixed) &lt;&lt; setprecision(2);</div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;                <span class="keywordflow">for</span> (RangeReading::const_iterator b=reading.begin(); b!=reading.end(); b++){</div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;                    <a class="code" href="classGMapping_1_1GridSlamProcessor.html#a25d322edaf8cdbc585493934918b3a6a">m_outputStream</a> &lt;&lt; *b &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;</div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;                }</div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;                <a class="code" href="structGMapping_1_1orientedpoint.html">OrientedPoint</a> p=reading.<a class="code" href="classGMapping_1_1RangeReading.html#a7f8c2ac4de3d9e67d671c76dc4932f13">getPose</a>();</div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;                <a class="code" href="classGMapping_1_1GridSlamProcessor.html#a25d322edaf8cdbc585493934918b3a6a">m_outputStream</a> &lt;&lt; setiosflags(ios::fixed) &lt;&lt; setprecision(6);</div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;                <a class="code" href="classGMapping_1_1GridSlamProcessor.html#a25d322edaf8cdbc585493934918b3a6a">m_outputStream</a> &lt;&lt; p.<a class="code" href="structGMapping_1_1point.html#a1e3816abbc8b56607fa741952fe74a8c">x</a> &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; p.<a class="code" href="structGMapping_1_1point.html#ae25e311e074409d6329c2e66741006f1">y</a> &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; p.<a class="code" href="structGMapping_1_1orientedpoint.html#a610fdfefb42f5c836de7ab9e94ba11d0">theta</a> &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; reading.<a class="code" href="classGMapping_1_1SensorReading.html#a54617dbdded28a4162d1b7f73e12adc3">getTime</a>()&lt;&lt; endl;</div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;                <a class="code" href="classGMapping_1_1GridSlamProcessor.html#a25d322edaf8cdbc585493934918b3a6a">m_outputStream</a> &lt;&lt; <span class="stringliteral">&quot;SM_UPDATE &quot;</span>&lt;&lt; <a class="code" href="classGMapping_1_1GridSlamProcessor.html#a67c2ade1a066269de12fe382999f2905">m_particles</a>.size() &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;</div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;                <span class="keywordflow">for</span> (ParticleVector::const_iterator it=<a class="code" href="classGMapping_1_1GridSlamProcessor.html#a67c2ade1a066269de12fe382999f2905">m_particles</a>.begin(); it!=<a class="code" href="classGMapping_1_1GridSlamProcessor.html#a67c2ade1a066269de12fe382999f2905">m_particles</a>.end(); it++){</div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;                    <span class="keyword">const</span> <a class="code" href="structGMapping_1_1orientedpoint.html">OrientedPoint</a>&amp; pose=it-&gt;pose;</div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;                    <a class="code" href="classGMapping_1_1GridSlamProcessor.html#a25d322edaf8cdbc585493934918b3a6a">m_outputStream</a> &lt;&lt; setiosflags(ios::fixed) &lt;&lt; setprecision(3) &lt;&lt;  pose.<a class="code" href="structGMapping_1_1point.html#a1e3816abbc8b56607fa741952fe74a8c">x</a> &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; pose.<a class="code" href="structGMapping_1_1point.html#ae25e311e074409d6329c2e66741006f1">y</a> &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;</div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;                    <a class="code" href="classGMapping_1_1GridSlamProcessor.html#a25d322edaf8cdbc585493934918b3a6a">m_outputStream</a> &lt;&lt; setiosflags(ios::fixed) &lt;&lt; setprecision(6) &lt;&lt;  pose.<a class="code" href="structGMapping_1_1orientedpoint.html#a610fdfefb42f5c836de7ab9e94ba11d0">theta</a> &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; it-&gt; weight &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;</div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;                }</div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;                <a class="code" href="classGMapping_1_1GridSlamProcessor.html#a25d322edaf8cdbc585493934918b3a6a">m_outputStream</a> &lt;&lt; endl;</div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;            }</div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;</div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;            <a class="code" href="classGMapping_1_1GridSlamProcessor.html#a877081a40963db2b11e90eb894ff207a">onScanmatchUpdate</a>();<span class="comment">//选最优的粒子更新gui中的地图</span></div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;</div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;            <a class="code" href="classGMapping_1_1GridSlamProcessor.html#a9984785d452344b9f6bd77c9af1ca37c">updateTreeWeights</a>(<span class="keyword">false</span>);</div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;</div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="classGMapping_1_1GridSlamProcessor.html#a7ad909f978d96737b5a336a15c65384c">m_infoStream</a>){</div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;                <a class="code" href="classGMapping_1_1GridSlamProcessor.html#a7ad909f978d96737b5a336a15c65384c">m_infoStream</a> &lt;&lt; <span class="stringliteral">&quot;neff= &quot;</span> &lt;&lt; m_neff  &lt;&lt; endl;</div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;            }</div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="classGMapping_1_1GridSlamProcessor.html#a25d322edaf8cdbc585493934918b3a6a">m_outputStream</a>.is_open()){</div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;                <a class="code" href="classGMapping_1_1GridSlamProcessor.html#a25d322edaf8cdbc585493934918b3a6a">m_outputStream</a> &lt;&lt; setiosflags(ios::fixed) &lt;&lt; setprecision(6);</div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;                <a class="code" href="classGMapping_1_1GridSlamProcessor.html#a25d322edaf8cdbc585493934918b3a6a">m_outputStream</a> &lt;&lt; <span class="stringliteral">&quot;NEFF &quot;</span> &lt;&lt; m_neff &lt;&lt; endl;</div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;            }</div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;</div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;            <a class="code" href="classGMapping_1_1GridSlamProcessor.html#a120d70ccab9ee0e133aef1ab9d7567fe">resample</a>(plainReading, adaptParticles, reading_copy);</div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;</div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;        }</div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;        <span class="keywordflow">else</span> <span class="comment">//第一次扫描注册</span></div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;        {</div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;            <a class="code" href="classGMapping_1_1GridSlamProcessor.html#a7ad909f978d96737b5a336a15c65384c">m_infoStream</a> &lt;&lt; <span class="stringliteral">&quot;Registering First Scan&quot;</span>&lt;&lt; endl;</div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;            <span class="keywordflow">for</span> (ParticleVector::iterator it=<a class="code" href="classGMapping_1_1GridSlamProcessor.html#a67c2ade1a066269de12fe382999f2905">m_particles</a>.begin(); it!=<a class="code" href="classGMapping_1_1GridSlamProcessor.html#a67c2ade1a066269de12fe382999f2905">m_particles</a>.end(); it++){</div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;                <a class="code" href="classGMapping_1_1GridSlamProcessor.html#ac50952d259590c4aeba22eee4e6437f5">m_matcher</a>.<a class="code" href="classGMapping_1_1ScanMatcher.html#a60ef33bbb1408a534a74efccd096fc16">invalidateActiveArea</a>();</div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;                <a class="code" href="classGMapping_1_1GridSlamProcessor.html#ac50952d259590c4aeba22eee4e6437f5">m_matcher</a>.<a class="code" href="classGMapping_1_1ScanMatcher.html#a6cf280963c3d391f2cc8677f8e2e11cd">computeActiveArea</a>(it-&gt;map, it-&gt;pose, plainReading);</div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;                <a class="code" href="classGMapping_1_1GridSlamProcessor.html#ac50952d259590c4aeba22eee4e6437f5">m_matcher</a>.<a class="code" href="classGMapping_1_1ScanMatcher.html#a0f3580f546f42463df8eb27bae244658">registerScan</a>(it-&gt;map, it-&gt;pose, plainReading);</div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;</div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;                <span class="comment">// cyr: not needed anymore, particles refer to the root in the beginning!</span></div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;                <a class="code" href="structGMapping_1_1GridSlamProcessor_1_1TNode.html">TNode</a>* node=<span class="keyword">new</span> <a class="code" href="structGMapping_1_1GridSlamProcessor_1_1TNode.html">TNode</a>(it-&gt;pose, 0., it-&gt;node,  0);</div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;                <span class="comment">//node-&gt;reading=0;</span></div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;                node-&gt;<a class="code" href="structGMapping_1_1GridSlamProcessor_1_1TNode.html#a574dd0cc9f28e7feb3d85a1ddb544d06">reading</a> = reading_copy;</div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;                it-&gt;node=node;</div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;</div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;            }</div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;        }</div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;        <span class="comment">//              cerr  &lt;&lt; &quot;Tree: normalizing, resetting and propagating weights at the end...&quot; ;</span></div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;        <a class="code" href="classGMapping_1_1GridSlamProcessor.html#a9984785d452344b9f6bd77c9af1ca37c">updateTreeWeights</a>(<span class="keyword">false</span>);    <span class="comment">//TreeWeights  ???</span></div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;        <span class="comment">//              cerr  &lt;&lt; &quot;.done!&quot; &lt;&lt;endl;</span></div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;</div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;        <span class="keyword">delete</span> [] plainReading;</div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;        <a class="code" href="classGMapping_1_1GridSlamProcessor.html#aeddf8ebf9784e818d93a4c5bb94e3c0d">m_lastPartPose</a>=<a class="code" href="classGMapping_1_1GridSlamProcessor.html#a242df41618ccce684a01229c3c752dc9">m_odoPose</a>; <span class="comment">//update the past pose for the next iteration</span></div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;        <a class="code" href="classGMapping_1_1GridSlamProcessor.html#a94ba410742ad6712b707e908e53da5e1">m_linearDistance</a>=0;</div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;        <a class="code" href="classGMapping_1_1GridSlamProcessor.html#aeede1ad148cba7c6080da5d8f00d4ac6">m_angularDistance</a>=0;</div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;        <a class="code" href="classGMapping_1_1GridSlamProcessor.html#a1c7e0a4fec2a31769f27fd17a9cfac3d">m_count</a>++;</div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;        processed=<span class="keyword">true</span>;</div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;</div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;        <span class="comment">//keep ready for the next step</span></div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;        <span class="keywordflow">for</span> (ParticleVector::iterator it=<a class="code" href="classGMapping_1_1GridSlamProcessor.html#a67c2ade1a066269de12fe382999f2905">m_particles</a>.begin(); it!=<a class="code" href="classGMapping_1_1GridSlamProcessor.html#a67c2ade1a066269de12fe382999f2905">m_particles</a>.end(); it++)</div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;        {</div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;            it-&gt;previousPose=it-&gt;pose;</div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;        }</div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;</div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;    }</div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classGMapping_1_1GridSlamProcessor.html#a25d322edaf8cdbc585493934918b3a6a">m_outputStream</a>.is_open())</div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;        <a class="code" href="classGMapping_1_1GridSlamProcessor.html#a25d322edaf8cdbc585493934918b3a6a">m_outputStream</a> &lt;&lt; flush;</div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;    <a class="code" href="classGMapping_1_1GridSlamProcessor.html#a50a21e3936bb5c122a9e4b8039be9bc9">m_readingCount</a>++;</div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;    <span class="keywordflow">return</span> processed;</div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;}</div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;</div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;</div>
<div class="line"><a name="l00497"></a><span class="lineno"><a class="line" href="classGMapping_1_1GridSlamProcessor.html#a4cd45d059a6cc1b82cb7688addccfd29">  497</a></span>&#160;std::ofstream&amp; <a class="code" href="classGMapping_1_1GridSlamProcessor.html#a4cd45d059a6cc1b82cb7688addccfd29">GridSlamProcessor::outputStream</a>(){</div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classGMapping_1_1GridSlamProcessor.html#a25d322edaf8cdbc585493934918b3a6a">m_outputStream</a>;</div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;}</div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;</div>
<div class="line"><a name="l00501"></a><span class="lineno"><a class="line" href="classGMapping_1_1GridSlamProcessor.html#ae7be39c0e2a9cea422e1a76c96a407b6">  501</a></span>&#160;std::ostream&amp; <a class="code" href="classGMapping_1_1GridSlamProcessor.html#ae7be39c0e2a9cea422e1a76c96a407b6">GridSlamProcessor::infoStream</a>(){</div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classGMapping_1_1GridSlamProcessor.html#a7ad909f978d96737b5a336a15c65384c">m_infoStream</a>;</div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;}</div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;</div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;</div>
<div class="line"><a name="l00506"></a><span class="lineno"><a class="line" href="classGMapping_1_1GridSlamProcessor.html#a4e7245e364731f61036e04782c68f397">  506</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="classGMapping_1_1GridSlamProcessor.html#a4e7245e364731f61036e04782c68f397">GridSlamProcessor::getBestParticleIndex</a>()<span class="keyword"> const</span>{</div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> bi=0;</div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;    <span class="keywordtype">double</span> bw=-<a class="code" href="namespaceGMapping.html#a027269368f9a63ebea99695c41a02b72">std::numeric_limits&lt;double&gt;::max</a>();</div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i=0; i&lt;<a class="code" href="classGMapping_1_1GridSlamProcessor.html#a67c2ade1a066269de12fe382999f2905">m_particles</a>.size(); i++)</div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;        <span class="keywordflow">if</span> (bw&lt;<a class="code" href="classGMapping_1_1GridSlamProcessor.html#a67c2ade1a066269de12fe382999f2905">m_particles</a>[i].weightSum){</div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;            bw=<a class="code" href="classGMapping_1_1GridSlamProcessor.html#a67c2ade1a066269de12fe382999f2905">m_particles</a>[i].weightSum;</div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;            bi=i;</div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;        }</div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;    <span class="keywordflow">return</span> (<span class="keywordtype">int</span>) bi;</div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;}</div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;</div>
<div class="line"><a name="l00517"></a><span class="lineno"><a class="line" href="classGMapping_1_1GridSlamProcessor.html#a877081a40963db2b11e90eb894ff207a">  517</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classGMapping_1_1GridSlamProcessor.html#a877081a40963db2b11e90eb894ff207a">GridSlamProcessor::onScanmatchUpdate</a>(){}</div>
<div class="line"><a name="l00518"></a><span class="lineno"><a class="line" href="classGMapping_1_1GridSlamProcessor.html#ae12e8c9b89dcb7f571464f5d79010339">  518</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classGMapping_1_1GridSlamProcessor.html#ae12e8c9b89dcb7f571464f5d79010339">GridSlamProcessor::onResampleUpdate</a>(){}</div>
<div class="line"><a name="l00519"></a><span class="lineno"><a class="line" href="classGMapping_1_1GridSlamProcessor.html#a2d39e20b20691b27676d36273b91a69e">  519</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classGMapping_1_1GridSlamProcessor.html#a2d39e20b20691b27676d36273b91a69e">GridSlamProcessor::onOdometryUpdate</a>(){}</div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;</div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;</div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;};<span class="comment">// end namespace</span></div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;</div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;</div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;</div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;</div>
<div class="ttc" id="gfs2stream_8cpp_html_a704f8c0bba2b3eb047aa1f950ea31c85"><div class="ttname"><a href="gfs2stream_8cpp.html#a704f8c0bba2b3eb047aa1f950ea31c85">delta</a></div><div class="ttdeci">const char *const *argv double delta</div><div class="ttdef"><b>Definition:</b> <a href="gfs2stream_8cpp_source.html#l00019">gfs2stream.cpp:19</a></div></div>
<div class="ttc" id="structGMapping_1_1orientedpoint_html_a610fdfefb42f5c836de7ab9e94ba11d0"><div class="ttname"><a href="structGMapping_1_1orientedpoint.html#a610fdfefb42f5c836de7ab9e94ba11d0">GMapping::orientedpoint::theta</a></div><div class="ttdeci">A theta</div><div class="ttdef"><b>Definition:</b> <a href="point_8h_source.html#l00060">point.h:60</a></div></div>
<div class="ttc" id="classGMapping_1_1OdometrySensor_html"><div class="ttname"><a href="classGMapping_1_1OdometrySensor.html">GMapping::OdometrySensor</a></div><div class="ttdef"><b>Definition:</b> <a href="odometrysensor_8h_source.html#l00009">odometrysensor.h:9</a></div></div>
<div class="ttc" id="classGMapping_1_1ScanMatcher_html_a0f3580f546f42463df8eb27bae244658"><div class="ttname"><a href="classGMapping_1_1ScanMatcher.html#a0f3580f546f42463df8eb27bae244658">GMapping::ScanMatcher::registerScan</a></div><div class="ttdeci">double registerScan(ScanMatcherMap &amp;map, const OrientedPoint &amp;p, const double *readings)</div><div class="ttdef"><b>Definition:</b> <a href="scanmatcher_8cpp_source.html#l00216">scanmatcher.cpp:216</a></div></div>
<div class="ttc" id="classGMapping_1_1GridSlamProcessor_html_a4cd45d059a6cc1b82cb7688addccfd29"><div class="ttname"><a href="classGMapping_1_1GridSlamProcessor.html#a4cd45d059a6cc1b82cb7688addccfd29">GMapping::GridSlamProcessor::outputStream</a></div><div class="ttdeci">std::ofstream &amp; outputStream()</div><div class="ttdef"><b>Definition:</b> <a href="gridslamprocessor_8cpp_source.html#l00497">gridslamprocessor.cpp:497</a></div></div>
<div class="ttc" id="gridslamprocessor_8h_html"><div class="ttname"><a href="gridslamprocessor_8h.html">gridslamprocessor.h</a></div></div>
<div class="ttc" id="classGMapping_1_1GridSlamProcessor_html_a877081a40963db2b11e90eb894ff207a"><div class="ttname"><a href="classGMapping_1_1GridSlamProcessor.html#a877081a40963db2b11e90eb894ff207a">GMapping::GridSlamProcessor::onScanmatchUpdate</a></div><div class="ttdeci">virtual void onScanmatchUpdate()</div><div class="ttdef"><b>Definition:</b> <a href="gridslamprocessor_8cpp_source.html#l00517">gridslamprocessor.cpp:517</a></div></div>
<div class="ttc" id="structGMapping_1_1GridSlamProcessor_1_1TNode_html"><div class="ttname"><a href="structGMapping_1_1GridSlamProcessor_1_1TNode.html">GMapping::GridSlamProcessor::TNode</a></div><div class="ttdef"><b>Definition:</b> <a href="gridslamprocessor_8h_source.html#l00042">gridslamprocessor.h:42</a></div></div>
<div class="ttc" id="namespaceGMapping_html_a02aca97274c6c5fe90097e517f88493d"><div class="ttname"><a href="namespaceGMapping.html#a02aca97274c6c5fe90097e517f88493d">GMapping::Point</a></div><div class="ttdeci">point&lt; double &gt; Point</div><div class="ttdef"><b>Definition:</b> <a href="point_8h_source.html#l00202">point.h:202</a></div></div>
<div class="ttc" id="structGMapping_1_1GridSlamProcessor_1_1TNode_html_a574dd0cc9f28e7feb3d85a1ddb544d06"><div class="ttname"><a href="structGMapping_1_1GridSlamProcessor_1_1TNode.html#a574dd0cc9f28e7feb3d85a1ddb544d06">GMapping::GridSlamProcessor::TNode::reading</a></div><div class="ttdeci">const RangeReading * reading</div><div class="ttdef"><b>Definition:</b> <a href="gridslamprocessor_8h_source.html#l00072">gridslamprocessor.h:72</a></div></div>
<div class="ttc" id="classGMapping_1_1GridSlamProcessor_html_a5992af06fd86724fbdc9471b2780ab49"><div class="ttname"><a href="classGMapping_1_1GridSlamProcessor.html#a5992af06fd86724fbdc9471b2780ab49">GMapping::GridSlamProcessor::TNodeVector</a></div><div class="ttdeci">std::vector&lt; GridSlamProcessor::TNode * &gt; TNodeVector</div><div class="ttdef"><b>Definition:</b> <a href="gridslamprocessor_8h_source.html#l00084">gridslamprocessor.h:84</a></div></div>
<div class="ttc" id="structGMapping_1_1GridSlamProcessor_1_1Particle_html_a51dc73563ad5e3035f8cb3b51965854a"><div class="ttname"><a href="structGMapping_1_1GridSlamProcessor_1_1Particle.html#a51dc73563ad5e3035f8cb3b51965854a">GMapping::GridSlamProcessor::Particle::Particle</a></div><div class="ttdeci">Particle(const ScanMatcherMap &amp;map)</div><div class="ttdef"><b>Definition:</b> <a href="gridslamprocessor_8cpp_source.html#l00236">gridslamprocessor.cpp:236</a></div></div>
<div class="ttc" id="classGMapping_1_1SensorReading_html_a7d074969806f41aa6971f44f043f6c9c"><div class="ttname"><a href="classGMapping_1_1SensorReading.html#a7d074969806f41aa6971f44f043f6c9c">GMapping::SensorReading::getSensor</a></div><div class="ttdeci">const Sensor * getSensor() const </div><div class="ttdef"><b>Definition:</b> <a href="sensorreading_8h_source.html#l00013">sensorreading.h:13</a></div></div>
<div class="ttc" id="classGMapping_1_1GridSlamProcessor_html_a79cee7069bb938f3b9d6d35b42b48ec6"><div class="ttname"><a href="classGMapping_1_1GridSlamProcessor.html#a79cee7069bb938f3b9d6d35b42b48ec6">GMapping::GridSlamProcessor::m_indexes</a></div><div class="ttdeci">std::vector&lt; unsigned int &gt; m_indexes</div><div class="ttdef"><b>Definition:</b> <a href="gridslamprocessor_8h_source.html#l00259">gridslamprocessor.h:259</a></div></div>
<div class="ttc" id="classGMapping_1_1GridSlamProcessor_html_ae7be39c0e2a9cea422e1a76c96a407b6"><div class="ttname"><a href="classGMapping_1_1GridSlamProcessor.html#ae7be39c0e2a9cea422e1a76c96a407b6">GMapping::GridSlamProcessor::infoStream</a></div><div class="ttdeci">std::ostream &amp; infoStream()</div><div class="ttdef"><b>Definition:</b> <a href="gridslamprocessor_8cpp_source.html#l00501">gridslamprocessor.cpp:501</a></div></div>
<div class="ttc" id="classGMapping_1_1GridSlamProcessor_html_ac015894484817bd962b0990fa64abfe4"><div class="ttname"><a href="classGMapping_1_1GridSlamProcessor.html#ac015894484817bd962b0990fa64abfe4">GMapping::GridSlamProcessor::setMatchingParameters</a></div><div class="ttdeci">void setMatchingParameters(double urange, double range, double sigma, int kernsize, double lopt, double aopt, int iterations, double likelihoodSigma=1, double likelihoodGain=1, unsigned int likelihoodSkip=0)</div><div class="ttdef"><b>Definition:</b> <a href="gridslamprocessor_8cpp_source.html#l00195">gridslamprocessor.cpp:195</a></div></div>
<div class="ttc" id="classGMapping_1_1GridSlamProcessor_html_a34c7f216947ee4c8ac05d5a53366aa5d"><div class="ttname"><a href="classGMapping_1_1GridSlamProcessor.html#a34c7f216947ee4c8ac05d5a53366aa5d">GMapping::GridSlamProcessor::processScan</a></div><div class="ttdeci">bool processScan(const RangeReading &amp;reading, int adaptParticles=0)</div><div class="ttdef"><b>Definition:</b> <a href="gridslamprocessor_8cpp_source.html#l00316">gridslamprocessor.cpp:316</a></div></div>
<div class="ttc" id="classGMapping_1_1GridSlamProcessor_html_a120d70ccab9ee0e133aef1ab9d7567fe"><div class="ttname"><a href="classGMapping_1_1GridSlamProcessor.html#a120d70ccab9ee0e133aef1ab9d7567fe">GMapping::GridSlamProcessor::resample</a></div><div class="ttdeci">bool resample(const double *plainReading, int adaptParticles, const RangeReading *rr=0)</div><div class="ttdef"><b>Definition:</b> <a href="gridslamprocessor_8h_source.html#l00076">gridslamprocessor.h:76</a></div></div>
<div class="ttc" id="classGMapping_1_1GridSlamProcessor_html_a5cc821f920af1f0e5b6f6c06a5281d35"><div class="ttname"><a href="classGMapping_1_1GridSlamProcessor.html#a5cc821f920af1f0e5b6f6c06a5281d35">GMapping::GridSlamProcessor::~GridSlamProcessor</a></div><div class="ttdeci">virtual ~GridSlamProcessor()</div><div class="ttdef"><b>Definition:</b> <a href="gridslamprocessor_8cpp_source.html#l00151">gridslamprocessor.cpp:151</a></div></div>
<div class="ttc" id="classGMapping_1_1GridSlamProcessor_html_ac50952d259590c4aeba22eee4e6437f5"><div class="ttname"><a href="classGMapping_1_1GridSlamProcessor.html#ac50952d259590c4aeba22eee4e6437f5">GMapping::GridSlamProcessor::m_matcher</a></div><div class="ttdeci">ScanMatcher m_matcher</div><div class="ttdef"><b>Definition:</b> <a href="gridslamprocessor_8h_source.html#l00166">gridslamprocessor.h:166</a></div></div>
<div class="ttc" id="classGMapping_1_1GridSlamProcessor_html_a2d39e20b20691b27676d36273b91a69e"><div class="ttname"><a href="classGMapping_1_1GridSlamProcessor.html#a2d39e20b20691b27676d36273b91a69e">GMapping::GridSlamProcessor::onOdometryUpdate</a></div><div class="ttdeci">virtual void onOdometryUpdate()</div><div class="ttdef"><b>Definition:</b> <a href="gridslamprocessor_8cpp_source.html#l00519">gridslamprocessor.cpp:519</a></div></div>
<div class="ttc" id="classGMapping_1_1GridSlamProcessor_html_a4435f10953b33bff663a6a7b21acb6cd"><div class="ttname"><a href="classGMapping_1_1GridSlamProcessor.html#a4435f10953b33bff663a6a7b21acb6cd">GMapping::GridSlamProcessor::m_pose</a></div><div class="ttdeci">OrientedPoint m_pose</div><div class="ttdef"><b>Definition:</b> <a href="gridslamprocessor_8h_source.html#l00274">gridslamprocessor.h:274</a></div></div>
<div class="ttc" id="stat_8h_html"><div class="ttname"><a href="stat_8h.html">stat.h</a></div></div>
<div class="ttc" id="classGMapping_1_1autoptr_html_aa641f3e33480944c12157ec2dbcfba43"><div class="ttname"><a href="classGMapping_1_1autoptr.html#aa641f3e33480944c12157ec2dbcfba43">GMapping::autoptr::m_reference</a></div><div class="ttdeci">reference * m_reference</div><div class="ttdef"><b>Definition:</b> <a href="autoptr_8h_source.html#l00024">autoptr.h:24</a></div></div>
<div class="ttc" id="namespaceGMapping_html_a027269368f9a63ebea99695c41a02b72"><div class="ttname"><a href="namespaceGMapping.html#a027269368f9a63ebea99695c41a02b72">GMapping::max</a></div><div class="ttdeci">point&lt; T &gt; max(const point&lt; T &gt; &amp;p1, const point&lt; T &gt; &amp;p2)</div><div class="ttdef"><b>Definition:</b> <a href="point_8h_source.html#l00146">point.h:146</a></div></div>
<div class="ttc" id="classGMapping_1_1RangeReading_html_a7f8c2ac4de3d9e67d671c76dc4932f13"><div class="ttname"><a href="classGMapping_1_1RangeReading.html#a7f8c2ac4de3d9e67d671c76dc4932f13">GMapping::RangeReading::getPose</a></div><div class="ttdeci">const OrientedPoint &amp; getPose() const </div><div class="ttdef"><b>Definition:</b> <a href="rangereading_8h_source.html#l00015">rangereading.h:15</a></div></div>
<div class="ttc" id="structGMapping_1_1orientedpoint_html"><div class="ttname"><a href="structGMapping_1_1orientedpoint.html">GMapping::orientedpoint&lt; double, double &gt;</a></div></div>
<div class="ttc" id="classGMapping_1_1GridSlamProcessor_html"><div class="ttname"><a href="classGMapping_1_1GridSlamProcessor.html">GMapping::GridSlamProcessor</a></div><div class="ttdef"><b>Definition:</b> <a href="gridslamprocessor_8h_source.html#l00034">gridslamprocessor.h:34</a></div></div>
<div class="ttc" id="classGMapping_1_1ScanMatcher_html_a64191c56d4fd0dedea13acf4228fb3d7"><div class="ttname"><a href="classGMapping_1_1ScanMatcher.html#a64191c56d4fd0dedea13acf4228fb3d7">GMapping::ScanMatcher::setLaserParameters</a></div><div class="ttdeci">void setLaserParameters(unsigned int beams, double *angles, const OrientedPoint &amp;lpose)</div><div class="ttdef"><b>Definition:</b> <a href="scanmatcher_8cpp_source.html#l00574">scanmatcher.cpp:574</a></div></div>
<div class="ttc" id="classGMapping_1_1GridSlamProcessor_html_a67c2ade1a066269de12fe382999f2905"><div class="ttname"><a href="classGMapping_1_1GridSlamProcessor.html#a67c2ade1a066269de12fe382999f2905">GMapping::GridSlamProcessor::m_particles</a></div><div class="ttdeci">ParticleVector m_particles</div><div class="ttdef"><b>Definition:</b> <a href="gridslamprocessor_8h_source.html#l00256">gridslamprocessor.h:256</a></div></div>
<div class="ttc" id="classGMapping_1_1RangeReading_html"><div class="ttname"><a href="classGMapping_1_1RangeReading.html">GMapping::RangeReading</a></div><div class="ttdef"><b>Definition:</b> <a href="rangereading_8h_source.html#l00010">rangereading.h:10</a></div></div>
<div class="ttc" id="classGMapping_1_1GridSlamProcessor_html_a82a12db62b99cf2f0cd3f475c81af77f"><div class="ttname"><a href="classGMapping_1_1GridSlamProcessor.html#a82a12db62b99cf2f0cd3f475c81af77f">GMapping::GridSlamProcessor::setUpdateDistances</a></div><div class="ttdeci">void setUpdateDistances(double linear, double angular, double resampleThreshold)</div><div class="ttdef"><b>Definition:</b> <a href="gridslamprocessor_8cpp_source.html#l00224">gridslamprocessor.cpp:224</a></div></div>
<div class="ttc" id="classGMapping_1_1ScanMatcher_html_a60ef33bbb1408a534a74efccd096fc16"><div class="ttname"><a href="classGMapping_1_1ScanMatcher.html#a60ef33bbb1408a534a74efccd096fc16">GMapping::ScanMatcher::invalidateActiveArea</a></div><div class="ttdeci">void invalidateActiveArea()</div><div class="ttdef"><b>Definition:</b> <a href="scanmatcher_8cpp_source.html#l00057">scanmatcher.cpp:57</a></div></div>
<div class="ttc" id="classGMapping_1_1GridSlamProcessor_html_a4277d04a56f1d03deecddcd3f62bf58d"><div class="ttname"><a href="classGMapping_1_1GridSlamProcessor.html#a4277d04a56f1d03deecddcd3f62bf58d">GMapping::GridSlamProcessor::setSensorMap</a></div><div class="ttdeci">void setSensorMap(const SensorMap &amp;smap)</div><div class="ttdef"><b>Definition:</b> <a href="gridslamprocessor_8cpp_source.html#l00242">gridslamprocessor.cpp:242</a></div></div>
<div class="ttc" id="classGMapping_1_1GridSlamProcessor_html_ae95960a9452ea93a6002a92ff8cd4777"><div class="ttname"><a href="classGMapping_1_1GridSlamProcessor.html#ae95960a9452ea93a6002a92ff8cd4777">GMapping::GridSlamProcessor::processTruePos</a></div><div class="ttdeci">void processTruePos(const OdometryReading &amp;odometry)</div><div class="ttdef"><b>Definition:</b> <a href="gridslamprocessor_8cpp_source.html#l00306">gridslamprocessor.cpp:306</a></div></div>
<div class="ttc" id="classGMapping_1_1GridSlamProcessor_html_a27039a2fcb5811629c0a1d5c96d50d95"><div class="ttname"><a href="classGMapping_1_1GridSlamProcessor.html#a27039a2fcb5811629c0a1d5c96d50d95">GMapping::GridSlamProcessor::clone</a></div><div class="ttdeci">GridSlamProcessor * clone() const </div><div class="ttdef"><b>Definition:</b> <a href="gridslamprocessor_8cpp_source.html#l00098">gridslamprocessor.cpp:98</a></div></div>
<div class="ttc" id="classGMapping_1_1Map_html"><div class="ttname"><a href="classGMapping_1_1Map.html">GMapping::Map&lt; PointAccumulator, HierarchicalArray2D&lt; PointAccumulator &gt; &gt;</a></div></div>
<div class="ttc" id="classGMapping_1_1HierarchicalArray2D_html"><div class="ttname"><a href="classGMapping_1_1HierarchicalArray2D.html">GMapping::HierarchicalArray2D&lt; PointAccumulator &gt;</a></div></div>
<div class="ttc" id="classGMapping_1_1GridSlamProcessor_html_aeddf8ebf9784e818d93a4c5bb94e3c0d"><div class="ttname"><a href="classGMapping_1_1GridSlamProcessor.html#aeddf8ebf9784e818d93a4c5bb94e3c0d">GMapping::GridSlamProcessor::m_lastPartPose</a></div><div class="ttdeci">OrientedPoint m_lastPartPose</div><div class="ttdef"><b>Definition:</b> <a href="gridslamprocessor_8h_source.html#l00272">gridslamprocessor.h:272</a></div></div>
<div class="ttc" id="classGMapping_1_1GridSlamProcessor_html_a25d322edaf8cdbc585493934918b3a6a"><div class="ttname"><a href="classGMapping_1_1GridSlamProcessor.html#a25d322edaf8cdbc585493934918b3a6a">GMapping::GridSlamProcessor::m_outputStream</a></div><div class="ttdeci">std::ofstream m_outputStream</div><div class="ttdef"><b>Definition:</b> <a href="gridslamprocessor_8h_source.html#l00303">gridslamprocessor.h:303</a></div></div>
<div class="ttc" id="structGMapping_1_1MotionModel_html_a52f6588b043916025f7f6bd760cf947a"><div class="ttname"><a href="structGMapping_1_1MotionModel.html#a52f6588b043916025f7f6bd760cf947a">GMapping::MotionModel::drawFromMotion</a></div><div class="ttdeci">OrientedPoint drawFromMotion(const OrientedPoint &amp;p, double linearMove, double angularMove) const </div><div class="ttdef"><b>Definition:</b> <a href="motionmodel_8cpp_source.html#l00013">motionmodel.cpp:13</a></div></div>
<div class="ttc" id="classGMapping_1_1GridSlamProcessor_html_aff434850cc82667bcd4740d50ae60755"><div class="ttname"><a href="classGMapping_1_1GridSlamProcessor.html#aff434850cc82667bcd4740d50ae60755">GMapping::GridSlamProcessor::scanMatch</a></div><div class="ttdeci">void scanMatch(const double *plainReading)</div><div class="ttdoc">GridSlamProcessor::scanMatch. </div><div class="ttdef"><b>Definition:</b> <a href="gridslamprocessor_8h_source.html#l00015">gridslamprocessor.h:15</a></div></div>
<div class="ttc" id="classGMapping_1_1GridSlamProcessor_html_a83d163ab15cf15856ea69507ec87904a"><div class="ttname"><a href="classGMapping_1_1GridSlamProcessor.html#a83d163ab15cf15856ea69507ec87904a">GMapping::GridSlamProcessor::period_</a></div><div class="ttdeci">double period_</div><div class="ttdef"><b>Definition:</b> <a href="gridslamprocessor_8h_source.html#l00253">gridslamprocessor.h:253</a></div></div>
<div class="ttc" id="classGMapping_1_1OdometryReading_html"><div class="ttname"><a href="classGMapping_1_1OdometryReading.html">GMapping::OdometryReading</a></div><div class="ttdef"><b>Definition:</b> <a href="odometryreading_8h_source.html#l00011">odometryreading.h:11</a></div></div>
<div class="ttc" id="structGMapping_1_1GridSlamProcessor_1_1Particle_html"><div class="ttname"><a href="structGMapping_1_1GridSlamProcessor_1_1Particle.html">GMapping::GridSlamProcessor::Particle</a></div><div class="ttdef"><b>Definition:</b> <a href="gridslamprocessor_8h_source.html#l00088">gridslamprocessor.h:88</a></div></div>
<div class="ttc" id="classGMapping_1_1GridSlamProcessor_html_ae12e8c9b89dcb7f571464f5d79010339"><div class="ttname"><a href="classGMapping_1_1GridSlamProcessor.html#ae12e8c9b89dcb7f571464f5d79010339">GMapping::GridSlamProcessor::onResampleUpdate</a></div><div class="ttdeci">virtual void onResampleUpdate()</div><div class="ttdef"><b>Definition:</b> <a href="gridslamprocessor_8cpp_source.html#l00518">gridslamprocessor.cpp:518</a></div></div>
<div class="ttc" id="classGMapping_1_1GridSlamProcessor_html_ae1fa20e9679abdbc23784e2dc17194b5"><div class="ttname"><a href="classGMapping_1_1GridSlamProcessor.html#ae1fa20e9679abdbc23784e2dc17194b5">GMapping::GridSlamProcessor::m_motionModel</a></div><div class="ttdeci">MotionModel m_motionModel</div><div class="ttdef"><b>Definition:</b> <a href="gridslamprocessor_8h_source.html#l00265">gridslamprocessor.h:265</a></div></div>
<div class="ttc" id="namespaceGMapping_html_af37440197d6baeaaf592e4980218742b"><div class="ttname"><a href="namespaceGMapping.html#af37440197d6baeaaf592e4980218742b">GMapping::SensorMap</a></div><div class="ttdeci">std::map&lt; std::string, Sensor * &gt; SensorMap</div><div class="ttdef"><b>Definition:</b> <a href="sensor_8h_source.html#l00019">sensor.h:19</a></div></div>
<div class="ttc" id="classGMapping_1_1ScanMatcher_html_aad081e39e5629e1532af566370b842fb"><div class="ttname"><a href="classGMapping_1_1ScanMatcher.html#aad081e39e5629e1532af566370b842fb">GMapping::ScanMatcher::setMatchingParameters</a></div><div class="ttdeci">void setMatchingParameters(double urange, double range, double sigma, int kernsize, double lopt, double aopt, int iterations, double likelihoodSigma=1, unsigned int likelihoodSkip=0)</div><div class="ttdef"><b>Definition:</b> <a href="scanmatcher_8cpp_source.html#l00727">scanmatcher.cpp:727</a></div></div>
<div class="ttc" id="classGMapping_1_1GridSlamProcessor_html_aec30b4ee3a767c9f50bb95236851a1be"><div class="ttname"><a href="classGMapping_1_1GridSlamProcessor.html#aec30b4ee3a767c9f50bb95236851a1be">GMapping::GridSlamProcessor::m_beams</a></div><div class="ttdeci">unsigned int m_beams</div><div class="ttdef"><b>Definition:</b> <a href="gridslamprocessor_8h_source.html#l00251">gridslamprocessor.h:251</a></div></div>
<div class="ttc" id="classGMapping_1_1GridSlamProcessor_html_a046b955e24777fd727328b62f8da54d7"><div class="ttname"><a href="classGMapping_1_1GridSlamProcessor.html#a046b955e24777fd727328b62f8da54d7">GMapping::GridSlamProcessor::getTrajectories</a></div><div class="ttdeci">TNodeVector getTrajectories() const </div><div class="ttdef"><b>Definition:</b> <a href="gridslamprocessor__tree_8cpp_source.html#l00040">gridslamprocessor_tree.cpp:40</a></div></div>
<div class="ttc" id="structGMapping_1_1GridSlamProcessor_1_1TNode_html_aa96443473844405f417fb8170b3d7243"><div class="ttname"><a href="structGMapping_1_1GridSlamProcessor_1_1TNode.html#aa96443473844405f417fb8170b3d7243">GMapping::GridSlamProcessor::TNode::parent</a></div><div class="ttdeci">TNode * parent</div><div class="ttdef"><b>Definition:</b> <a href="gridslamprocessor_8h_source.html#l00069">gridslamprocessor.h:69</a></div></div>
<div class="ttc" id="classGMapping_1_1RangeSensor_html"><div class="ttname"><a href="classGMapping_1_1RangeSensor.html">GMapping::RangeSensor</a></div><div class="ttdef"><b>Definition:</b> <a href="rangesensor_8h_source.html#l00010">rangesensor.h:10</a></div></div>
<div class="ttc" id="classGMapping_1_1GridSlamProcessor_html_a7ad909f978d96737b5a336a15c65384c"><div class="ttname"><a href="classGMapping_1_1GridSlamProcessor.html#a7ad909f978d96737b5a336a15c65384c">GMapping::GridSlamProcessor::m_infoStream</a></div><div class="ttdeci">std::ostream &amp; m_infoStream</div><div class="ttdef"><b>Definition:</b> <a href="gridslamprocessor_8h_source.html#l00306">gridslamprocessor.h:306</a></div></div>
<div class="ttc" id="classGMapping_1_1SensorReading_html_a54617dbdded28a4162d1b7f73e12adc3"><div class="ttname"><a href="classGMapping_1_1SensorReading.html#a54617dbdded28a4162d1b7f73e12adc3">GMapping::SensorReading::getTime</a></div><div class="ttdeci">double getTime() const </div><div class="ttdef"><b>Definition:</b> <a href="sensorreading_8h_source.html#l00011">sensorreading.h:11</a></div></div>
<div class="ttc" id="classGMapping_1_1autoptr_html"><div class="ttname"><a href="classGMapping_1_1autoptr.html">GMapping::autoptr</a></div><div class="ttdef"><b>Definition:</b> <a href="autoptr_8h_source.html#l00008">autoptr.h:8</a></div></div>
<div class="ttc" id="structGMapping_1_1point_html_ae25e311e074409d6329c2e66741006f1"><div class="ttname"><a href="structGMapping_1_1point.html#ae25e311e074409d6329c2e66741006f1">GMapping::point::y</a></div><div class="ttdeci">T y</div><div class="ttdef"><b>Definition:</b> <a href="point_8h_source.html#l00016">point.h:16</a></div></div>
<div class="ttc" id="classGMapping_1_1GridSlamProcessor_html_aeede1ad148cba7c6080da5d8f00d4ac6"><div class="ttname"><a href="classGMapping_1_1GridSlamProcessor.html#aeede1ad148cba7c6080da5d8f00d4ac6">GMapping::GridSlamProcessor::m_angularDistance</a></div><div class="ttdeci">double m_angularDistance</div><div class="ttdef"><b>Definition:</b> <a href="gridslamprocessor_8h_source.html#l00275">gridslamprocessor.h:275</a></div></div>
<div class="ttc" id="classGMapping_1_1RangeSensor_html_ae94a67c529c644d4193a15da20bf9615"><div class="ttname"><a href="classGMapping_1_1RangeSensor.html#ae94a67c529c644d4193a15da20bf9615">GMapping::RangeSensor::getPose</a></div><div class="ttdeci">OrientedPoint getPose() const </div><div class="ttdef"><b>Definition:</b> <a href="rangesensor_8h_source.html#l00025">rangesensor.h:25</a></div></div>
<div class="ttc" id="classGMapping_1_1GridSlamProcessor_html_a50a21e3936bb5c122a9e4b8039be9bc9"><div class="ttname"><a href="classGMapping_1_1GridSlamProcessor.html#a50a21e3936bb5c122a9e4b8039be9bc9">GMapping::GridSlamProcessor::m_readingCount</a></div><div class="ttdeci">int m_readingCount</div><div class="ttdef"><b>Definition:</b> <a href="gridslamprocessor_8h_source.html#l00271">gridslamprocessor.h:271</a></div></div>
<div class="ttc" id="classGMapping_1_1GridSlamProcessor_html_a242df41618ccce684a01229c3c752dc9"><div class="ttname"><a href="classGMapping_1_1GridSlamProcessor.html#a242df41618ccce684a01229c3c752dc9">GMapping::GridSlamProcessor::m_odoPose</a></div><div class="ttdeci">OrientedPoint m_odoPose</div><div class="ttdef"><b>Definition:</b> <a href="gridslamprocessor_8h_source.html#l00273">gridslamprocessor.h:273</a></div></div>
<div class="ttc" id="classGMapping_1_1GridSlamProcessor_html_a736f647e15e7b3e5f853920beb7b2b80"><div class="ttname"><a href="classGMapping_1_1GridSlamProcessor.html#a736f647e15e7b3e5f853920beb7b2b80">GMapping::GridSlamProcessor::GridSlamProcessor</a></div><div class="ttdeci">GridSlamProcessor()</div><div class="ttdef"><b>Definition:</b> <a href="gridslamprocessor_8cpp_source.html#l00020">gridslamprocessor.cpp:20</a></div></div>
<div class="ttc" id="structGMapping_1_1point_html_a1e3816abbc8b56607fa741952fe74a8c"><div class="ttname"><a href="structGMapping_1_1point.html#a1e3816abbc8b56607fa741952fe74a8c">GMapping::point::x</a></div><div class="ttdeci">T x</div><div class="ttdef"><b>Definition:</b> <a href="point_8h_source.html#l00016">point.h:16</a></div></div>
<div class="ttc" id="classGMapping_1_1GridSlamProcessor_html_a0993feeb34469143808a6ff2d9d1ae6b"><div class="ttname"><a href="classGMapping_1_1GridSlamProcessor.html#a0993feeb34469143808a6ff2d9d1ae6b">GMapping::GridSlamProcessor::init</a></div><div class="ttdeci">void init(unsigned int size, double xmin, double ymin, double xmax, double ymax, double delta, OrientedPoint initialPose=OrientedPoint(0, 0, 0))</div><div class="ttdef"><b>Definition:</b> <a href="gridslamprocessor_8cpp_source.html#l00268">gridslamprocessor.cpp:268</a></div></div>
<div class="ttc" id="classGMapping_1_1OdometrySensor_html_a3454b256a55d2176132939a6842aa873"><div class="ttname"><a href="classGMapping_1_1OdometrySensor.html#a3454b256a55d2176132939a6842aa873">GMapping::OdometrySensor::isIdeal</a></div><div class="ttdeci">bool isIdeal() const </div><div class="ttdef"><b>Definition:</b> <a href="odometrysensor_8h_source.html#l00012">odometrysensor.h:12</a></div></div>
<div class="ttc" id="classGMapping_1_1GridSlamProcessor_html_af5c4b7f2992f1d11b2e373dbd410cab2"><div class="ttname"><a href="classGMapping_1_1GridSlamProcessor.html#af5c4b7f2992f1d11b2e373dbd410cab2">GMapping::GridSlamProcessor::setMotionModelParameters</a></div><div class="ttdeci">void setMotionModelParameters(double srr, double srt, double str, double stt)</div><div class="ttdef"><b>Definition:</b> <a href="gridslamprocessor_8cpp_source.html#l00212">gridslamprocessor.cpp:212</a></div></div>
<div class="ttc" id="classGMapping_1_1ScanMatcher_html_a6cf280963c3d391f2cc8677f8e2e11cd"><div class="ttname"><a href="classGMapping_1_1ScanMatcher.html#a6cf280963c3d391f2cc8677f8e2e11cd">GMapping::ScanMatcher::computeActiveArea</a></div><div class="ttdeci">void computeActiveArea(ScanMatcherMap &amp;map, const OrientedPoint &amp;p, const double *readings)</div><div class="ttdef"><b>Definition:</b> <a href="scanmatcher_8cpp_source.html#l00116">scanmatcher.cpp:116</a></div></div>
<div class="ttc" id="namespaceGMapping_html_a907bba3f1a2120b0374630ebf6101d5a"><div class="ttname"><a href="namespaceGMapping.html#a907bba3f1a2120b0374630ebf6101d5a">GMapping::m_distanceThresholdCheck</a></div><div class="ttdeci">const double m_distanceThresholdCheck</div><div class="ttdef"><b>Definition:</b> <a href="gridslamprocessor_8cpp_source.html#l00016">gridslamprocessor.cpp:16</a></div></div>
<div class="ttc" id="classGMapping_1_1OdometryReading_html_a42e7772cdb3724a43ed1a2fb0d27c15b"><div class="ttname"><a href="classGMapping_1_1OdometryReading.html#a42e7772cdb3724a43ed1a2fb0d27c15b">GMapping::OdometryReading::getPose</a></div><div class="ttdeci">const OrientedPoint &amp; getPose() const </div><div class="ttdef"><b>Definition:</b> <a href="odometryreading_8h_source.html#l00014">odometryreading.h:14</a></div></div>
<div class="ttc" id="classGMapping_1_1GridSlamProcessor_html_a1c7e0a4fec2a31769f27fd17a9cfac3d"><div class="ttname"><a href="classGMapping_1_1GridSlamProcessor.html#a1c7e0a4fec2a31769f27fd17a9cfac3d">GMapping::GridSlamProcessor::m_count</a></div><div class="ttdeci">int m_count</div><div class="ttdef"><b>Definition:</b> <a href="gridslamprocessor_8h_source.html#l00271">gridslamprocessor.h:271</a></div></div>
<div class="ttc" id="classGMapping_1_1GridSlamProcessor_html_a4e7245e364731f61036e04782c68f397"><div class="ttname"><a href="classGMapping_1_1GridSlamProcessor.html#a4e7245e364731f61036e04782c68f397">GMapping::GridSlamProcessor::getBestParticleIndex</a></div><div class="ttdeci">int getBestParticleIndex() const </div><div class="ttdef"><b>Definition:</b> <a href="gridslamprocessor_8cpp_source.html#l00506">gridslamprocessor.cpp:506</a></div></div>
<div class="ttc" id="classGMapping_1_1GridSlamProcessor_html_a9984785d452344b9f6bd77c9af1ca37c"><div class="ttname"><a href="classGMapping_1_1GridSlamProcessor.html#a9984785d452344b9f6bd77c9af1ca37c">GMapping::GridSlamProcessor::updateTreeWeights</a></div><div class="ttdeci">void updateTreeWeights(bool weightsAlreadyNormalized=false)</div><div class="ttdef"><b>Definition:</b> <a href="gridslamprocessor__tree_8cpp_source.html#l00198">gridslamprocessor_tree.cpp:198</a></div></div>
<div class="ttc" id="classGMapping_1_1GridSlamProcessor_html_a3f40a117057427e725aa92739dbe2480"><div class="ttname"><a href="classGMapping_1_1GridSlamProcessor.html#a3f40a117057427e725aa92739dbe2480">GMapping::GridSlamProcessor::last_update_time_</a></div><div class="ttdeci">double last_update_time_</div><div class="ttdef"><b>Definition:</b> <a href="gridslamprocessor_8h_source.html#l00252">gridslamprocessor.h:252</a></div></div>
<div class="ttc" id="classGMapping_1_1GridSlamProcessor_html_a94ba410742ad6712b707e908e53da5e1"><div class="ttname"><a href="classGMapping_1_1GridSlamProcessor.html#a94ba410742ad6712b707e908e53da5e1">GMapping::GridSlamProcessor::m_linearDistance</a></div><div class="ttdeci">double m_linearDistance</div><div class="ttdef"><b>Definition:</b> <a href="gridslamprocessor_8h_source.html#l00275">gridslamprocessor.h:275</a></div></div>
<div class="ttc" id="classGMapping_1_1RangeSensor_html_ac2cd935c61dc0c7158b0a7f6d00b150c"><div class="ttname"><a href="classGMapping_1_1RangeSensor.html#ac2cd935c61dc0c7158b0a7f6d00b150c">GMapping::RangeSensor::beams</a></div><div class="ttdeci">const std::vector&lt; Beam &gt; &amp; beams() const </div><div class="ttdef"><b>Definition:</b> <a href="rangesensor_8h_source.html#l00023">rangesensor.h:23</a></div></div>
<div class="ttc" id="classGMapping_1_1Map_html_a8bc733ffc30a93d5ccc2d50fde1b0bcb"><div class="ttname"><a href="classGMapping_1_1Map.html#a8bc733ffc30a93d5ccc2d50fde1b0bcb">GMapping::Map::storage</a></div><div class="ttdeci">Storage &amp; storage()</div><div class="ttdef"><b>Definition:</b> <a href="map_8h_source.html#l00081">map.h:81</a></div></div>
<div class="ttc" id="structGMapping_1_1GridSlamProcessor_1_1Particle_html_a9c91ccdf7009b50785d939e1791ae4be"><div class="ttname"><a href="structGMapping_1_1GridSlamProcessor_1_1Particle.html#a9c91ccdf7009b50785d939e1791ae4be">GMapping::GridSlamProcessor::Particle::node</a></div><div class="ttdeci">TNode * node</div><div class="ttdef"><b>Definition:</b> <a href="gridslamprocessor_8h_source.html#l00122">gridslamprocessor.h:122</a></div></div>
</div><!-- fragment --></div><!-- contents -->

<br clear="all" />
<hr size="1"><div style="align: right;">
<a href="http://wiki.ros.org/slam_gmapping">slam_gmapping</a><br />
Author(s): Brian Gerkey</br />
<small>autogenerated on Sun Feb 21 2016 15:19:53</small>
</div>
</body>
</html>
